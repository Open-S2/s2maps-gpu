(()=>{"use strict";var e,t,n={225:(e,t,n)=>{n.d(t,{default:()=>g});var r=n(840),o=n.n(r),i=n(465),a=n(243),s=n(89),u=n(272);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function y(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&m(e,t)}(j,e);var t,r,i,c,p,g,k,C=(g=j,k=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(g);if(k){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function j(e,t,n,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,j),_(b(o=C.call(this,e)),"id",void 0),_(b(o),"parent",void 0),_(b(o),"_canvas",void 0),_(b(o),"_canDraw",!1),_(b(o),"_interactive",!1),_(b(o),"_scrollZoom",!0),_(b(o),"renderNextFrame",!1),_(b(o),"mousePosition",[0,0]),_(b(o),"injectionQueue",[]),_(b(o),"resizeQueued",null),_(b(o),"dragPan",void 0),_(b(o),"canMove",!0),_(b(o),"canZoom",!0),_(b(o),"mouseMoved",!0),_(b(o),"currAnimFunction",void 0),_(b(o),"currFeature",null),o.id=n,o.parent=r,o._canvas=t;var i=e.style,a=e.webworker,s=e.interactive,u=e.scrollZoom,c=e.canMove,l=e.canZoom;return o.webworker=!!a,s&&(o._interactive=s),u&&(o._scrollZoom=u),!1===c&&(o.canMove=!1),!1===l&&(o.canZoom=!1),o._buildPaint(e,i),o}return t=j,r=[{key:"_buildPaint",value:(p=v(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._createPainter(t);case 2:if(!e.sent){e.next=8;break}return this._setupCanvas(),this.style=new u.Z(t,this),e.next=8,this.setStyle(n,!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"_createPainter",value:(c=v(o().mark((function e(t){var r,i,a,s,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.contextType,a=0,3===r?(i=this._canvas.getContext("webgpu"),a=3):(s={powerPreference:"high-performance",antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,alpha:!0,stencil:!0},2===r?(i=this._canvas.getContext("webgl2",s),a=2):(i=this._canvas.getContext("webgl",s),a=1)),i){e.next=7;break}return e.abrupt("return",!1);case 7:if(3!==a){e.next=14;break}return e.next=10,n.e(449).then(n.bind(n,449)).then((function(e){return e.Painter}));case 10:u=e.sent,this.painter=new u,e.next=18;break;case 14:return e.next=16,Promise.resolve().then(n.bind(n,330)).then((function(e){return e.Painter}));case 16:c=e.sent,this.painter=new c(i,a,t);case 18:return e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"delete",value:function(){this.tileCache.deleteAll(),this.style={},this._draw=function(){},this.painter.delete()}},{key:"jumpTo",value:function(e,t,n){this.projector.setPosition(e,t,n),this.render()}},{key:"animateTo",value:function(e,t){var n=this,r=new s.Z(this.projector,t);("flyTo"===e?r.flyTo():r.easeTo())&&(this.currAnimFunction=function(e){return n._animate(r,.001*e)},this.render())}},{key:"setStyle",value:(i=v(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._canDraw=!1,this.tileCache.deleteAll(),e.next=4,this.style.buildStyle(t);case 4:this._canDraw=!0,this.projector.setStyleParameters(this.style,n),this.render();case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"updateStyle",value:function(e){}},{key:"clearSource",value:function(e){this.tileCache.forEach((function(t){t.deleteSources(e)})),this.style.deleteSources(e),this.painter.dirty=!0,this.render()}},{key:"resetSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._resetTileCache(e.map((function(e){return e[0]})),t,n);r.length&&(this.webworker?postMessage({mapID:this.id,type:"tilerequest",tiles:r,sources:e}):window.S2WorkerPool.tileRequest(this.id,r,e)),this.painter.dirty=!0,this.render()}},{key:"addLayer",value:function(e,t){var n=this._resetTileCache(null,!1,!0);this.style.addLayer(e,t,n),this.render()}},{key:"removeLayer",value:function(e){var t=this.style.removeLayer(e);this.tileCache.forEach((function(e){e.removeLayer(t)})),this.render()}},{key:"reorderLayers",value:function(e){this.style.reorderLayers(e),this.tileCache.forEach((function(t){t.reorderLayers(e)})),this.render()}},{key:"setMoveState",value:function(e){this.canMove=!!e}},{key:"setZoomState",value:function(e){this.canZoom=!!e}},{key:"updateCompass",value:function(e,t){var n=this.projector;this.currAnimFunction=null,n.setCompass(n.bearing+(0|e),n.pitch+(0|t)),this.render()}},{key:"mouseupCompass",value:function(){var e=this,t=this.projector,n=t.bearing;if(n){var r=n>=-10&&n<=10?0:n<=-167.5?-180:n>=167.5?180:void 0;if(!isNaN(r)){var o=new s.Z(t,{duration:1,bearing:r});o.compassTo(),this.currAnimFunction=function(t){return e._animate(o,.001*t)},this.render()}}}},{key:"resetCompass",value:function(){var e=this,t=this.projector,n=t.bearing,r=t.pitch,o=n&&n>90?1.75:1,i=new s.Z(t,{duration:o,bearing:0,pitch:n?null:0|r});i.compassTo(),this.currAnimFunction=function(t){return e._animate(i,.001*t)},this.render()}},{key:"resize",value:function(e,t){this.resizeQueued={width:e,height:t},this.render()}},{key:"screenshot",value:function(){var e=this;requestAnimationFrame((function(){if(e._fullyRenderedScreen()){var t=e.painter.getScreen();e.webworker?postMessage({type:"screenshot",screen:t}):e.parent.dispatchEvent(new CustomEvent("screenshot",{detail:t}))}else e.screenshot()}))}},{key:"injectData",value:function(e){"flush"===e.type?this._injectData(e):this.injectionQueue.push(e),this.render()}},{key:"colorMode",value:function(e){this.painter.setColorMode(e),this.render()}},{key:"onCanvasMouseMove",value:function(e,t){this.style&&this.style.interactive&&!this.projector.dirty&&(this.mousePosition[0]=e,this.mousePosition[1]=t,this.mouseMoved=!0,this.render())}},{key:"onTouchStart",value:function(e){if(this.dragPan.onTouchStart(e),!(!this.style.interactive||this.projector.dirty||e.length>1)){var t=e[0],n=t.x,r=t.y;this.mousePosition[0]=n,this.mousePosition[1]=r,this.mouseMoved=!0,this.render()}}},{key:"navEvent",value:function(e,t,n){var r=this,o=this.projector.zoom+("zoomIn"===e?1:-1),i=new s.Z(this.projector,{duration:1.5,zoom:o,lon:t,lat:n});i.zoomTo(),this.currAnimFunction=function(e){return r._animate(i,.001*e)},this.render()}},{key:"_contextLost",value:function(){}},{key:"_contextRestored",value:function(){}},{key:"_resetTileCache",value:function(e,t,n){var r=this,o=this.getTiles(),i=[];return this.tileCache.forEach((function(a,s){if(t||o.includes(s)){var u=a.id,c=a.face,l=a.zoom,h=a.i,d=a.j,p=a.bbox,v=a.division,f=a.size;i.push({id:u,face:c,zoom:l,i:h,j:d,bbox:p,division:v,size:f}),!n&&e&&a.deleteSources(e)}else r.tileCache.delete(s)})),i}},{key:"_setupCanvas",value:function(){var e=this,t=e._canvas,n=e._interactive,r=e._scrollZoom;t.addEventListener("webglcontextlost",e._contextLost,!1),t.addEventListener("webglcontextrestored",e._contextRestored,!1);var o=e.dragPan=new a.Z;n&&(r&&(o.zoomActive=!0),o.addEventListener("move",e._onMovement.bind(e)),o.addEventListener("swipe",e._onSwipe.bind(e)),o.addEventListener("zoom",(function(){e._onZoom(o.zoom)})),o.addEventListener("click",e._onClick.bind(e)),o.addEventListener("doubleClick",e._onDoubleClick.bind(e))),e._resizeCamera(t.width,t.height)}},{key:"_handleFeatureChange",value:function(e){var t=this.currFeature;this.currFeature=e,this.webworker?postMessage({type:"mouseleave",feature:t}):(t&&this.parent.dispatchEvent(new CustomEvent("mouseleave",{detail:t})),this._canvas.style.cursor="default"),this.webworker?postMessage({type:"mouseenter",feature:e}):e&&(this.parent.dispatchEvent(new CustomEvent("mouseenter",{detail:e})),this._canvas.style.cursor=e.__cursor||"default"),this.render()}},{key:"_resize",value:function(){var e=this._canvas,t=this.resizeQueued;if(t){this.currAnimFunction=null;var n=t.width,r=t.height;e.width=n,e.height=r,this._resizeCamera(n,r),this.resizeQueued=null}}},{key:"_onClick",value:function(e){var t=e.detail,n=this.projector,r=this.currFeature,o=this.parent,i=t.posX,a=t.posY,s=l(n.cursorToLonLat(i,a),2),u=s[0],c=s[1];this.webworker?postMessage({type:"click",feature:r,lon:u,lat:c}):(o.info&&o.info.click(r,u,c),o.dispatchEvent(new CustomEvent("click",{detail:{feature:r,lon:u,lat:c}})))}},{key:"_onDoubleClick",value:function(e){var t=e.detail,n=t.posX,r=t.posY,o=l(this.projector.cursorToLonLat(n,r),2),i=o[0],a=o[1];this.navEvent("zoomIn",i,a)}},{key:"_onPositionUpdate",value:function(){var e=this.projector,t=e.zoom,n=e.lon,r=e.lat;this.webworker?postMessage({type:"pos",zoom:t,lon:n,lat:r}):this.parent.dispatchEvent(new CustomEvent("pos",{detail:{zoom:t,lon:n,lat:r}}))}},{key:"_onCanvasMouseMove",value:function(){var e,t,n=(e=this.painter.context).getFeatureAtMousePosition.apply(e,function(e){if(Array.isArray(e))return d(e)}(t=this.mousePosition)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());if(!n&&this.currFeature)this._handleFeatureChange(null);else if(n&&(!this.currFeature||this.currFeature.__id!==n)){var r,o=!1,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.tilesInView);try{for(i.s();!(r=i.n()).done;){var a=r.value.findInteractiveFeature(n);if(a){this._handleFeatureChange(a),o=!0;break}}}catch(e){i.e(e)}finally{i.f()}!o&&this.currFeature&&this._handleFeatureChange(null)}}},{key:"_onZoom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.dragPan.clear(),this.canZoom&&(this.currAnimFunction=null,e&&this.projector.onZoom(e,t,n),this.render())}},{key:"_onMovement",value:function(e){if(this.canMove){var t=this.projector,n=this.dragPan,r=n.movementX,o=n.movementY;t.onMove(r,o),this.render()}}},{key:"_onSwipe",value:function(e){var t=this;if(this.canMove){var n=this.projector,r=this.dragPan,o=r.movementX,i=r.movementY,a=new s.Z(n,{duration:1.75});a.swipeTo(o,i),this.currAnimFunction=function(e){return t._animate(a,.001*e)},this.render()}}},{key:"_animate",value:function(e,t){var n=this.dragPan.mouseActive;this.render(),(e.increment(t)||n)&&(this.currAnimFunction=null)}},{key:"_updatePainter",value:function(){this.painter.dirty=!0,this.render()}},{key:"render",value:function(){var e=this;e._canDraw&&(e.renderNextFrame||(e.renderNextFrame=!0,requestAnimationFrame((function(t){if(e.renderNextFrame=!1,e.timeCache&&e.timeCache.animate(t,e._updatePainter.bind(e)),e.currAnimFunction&&e.currAnimFunction(t),e.resizeQueued&&e._resize(),e.injectionQueue.length){var n=e.injectionQueue.pop();e._injectData(n),e.render()}var r=e.projector.dirty;r&&(e.render(),e._onPositionUpdate()),e._draw(),e.mouseMoved&&!r&&(e.mouseMoved=!1,e._onCanvasMouseMove())}))))}}],r&&f(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),j}(i.Z)},278:(e,t,n)=>{var r=n(225);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=new(function(){function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=void 0,"map"in this?Object.defineProperty(this,"map",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.map=t}var t,n;return t=e,(n=[{key:"onMessage",value:function(e){var t=e.data,n=t.type;"canvas"===n?this._prepCanvas(t.options,t.canvas,t.id):"resize"===n?this.map.resize(t.width,t.height):"scroll"===n?this.map._onZoom(t.deltaY,t.clientX-t.rect.left,t.clientY-t.rect.top):"mousedown"===n?this.map.dragPan.onMouseDown():"mouseup"===n?this.map.dragPan.onMouseUp(t.clientX-t.rect.left-t.rect.width/2,t.rect.height/2-t.clientY-t.rect.top):"mousemove"===n?this.map.dragPan.onMouseMove(t.movementX,t.movementY):"canvasmousemove"===n?this.map.onCanvasMouseMove(t.x,t.y):"touchstart"===n?this.map.onTouchStart(t.touchEvent):"touchend"===n?this.map.dragPan.onTouchEnd(t.touchEvent):"touchmove"===n?this.map.dragPan.onTouchMove(t.touchEvent):"nav"===n?this.map.navEvent(t.ctrl):"updateCompass"===n?this.map.updateCompass(t.bearing):"mouseupCompass"===n?this.map.mouseupCompass():"resetCompass"===n?this.map.resetCompass():"colorMode"===n?this.map.colorMode(t.mode):"setStyle"===n?this.map.setStyle(t.style,t.ignorePosition):"updateStyle"===n?this.map.updateStyle(t.style):"jumpTo"===n?this.map.jumpTo(t.lon,t.lat,t.zoom):"easeTo"===n||"flyTo"===n?this.map.animateTo(n,t.directions):"moveState"===n?this.map.canMove=!!t.state:"zoomState"===n?this.map.canZoom=!!t.state:"screenshot"===n?this.map.screenshot():"resetSource"===n?this.map.resetSource(t.sourceNames,t.keepCache,t.awaitReplace):"clearSource"===n?this.map.clearSource(t.sourceNames):"addLayer"===n?this.map.addLayer(t.layer,t.nameIndex):"updateLayer"===n?this.map.updateLayer(t.layer,t.nameIndex,t.fullUpdate):"removeLayer"===n?this.map.removeLayer(t.nameIndex):"reorderLayers"===n?this.map.reorderLayers(t.layerChanges):"delete"===n?this.map.delete():this.map.injectData(t)}},{key:"_prepCanvas",value:function(e,t,n){e.webworker=!0,this.map=new r.default(e,t,n)}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}());onmessage=i.onMessage.bind(i)}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={id:e,loaded:!1,exports:{}};return n[e](i,i.exports,o),i.loaded=!0,i.exports}o.m=n,o.x=()=>{var e=o.O(void 0,[840,115,14],(()=>o(278)));return o.O(e)},e=[],o.O=(t,n,r,i)=>{if(!n){var a=1/0;for(l=0;l<e.length;l++){for(var[n,r,i]=e[l],s=!0,u=0;u<n.length;u++)(!1&i||a>=i)&&Object.keys(o.O).every((e=>o.O[e](n[u])))?n.splice(u--,1):(s=!1,i<a&&(a=i));if(s){e.splice(l--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,r,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>e+".min.js",o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="http://localhost:3000/s2maps-gl/v0.3.3-dev/",(()=>{var e={875:1,225:1};o.f.i=(t,n)=>{e[t]||importScripts(o.p+o.u(t))};var t=this.webpackChunk=this.webpackChunk||[],n=t.push.bind(t);t.push=t=>{var[r,i,a]=t;for(var s in i)o.o(i,s)&&(o.m[s]=i[s]);for(a&&a(o);r.length;)e[r.pop()]=1;n(t)}})(),t=o.x,o.x=()=>Promise.all([840,115,14].map(o.e,o)).then(t),o.x()})();