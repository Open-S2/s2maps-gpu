"use strict";(this.webpackChunk=this.webpackChunk||[]).push([[14],{330:(t,e,r)=>{r.r(e),r.d(e,{Painter:()=>R});var n=r(840),i=r.n(n);function a(t,e){var r=t.gl;"vector"===e.type?(e.vao=r.createVertexArray(),r.bindVertexArray(e.vao),e.codeTypeArray&&e.codeTypeArray.length&&(e.codeTypeBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.codeTypeBuffer),r.bufferData(r.ARRAY_BUFFER,e.codeTypeArray,r.STATIC_DRAW),r.enableVertexAttribArray(7),r.vertexAttribPointer(7,1,r.UNSIGNED_BYTE,!1,0,0)),e.indexArray&&e.indexArray.length&&(e.indexBuffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.indexArray,r.STATIC_DRAW)),e.fillIDArray&&e.fillIDArray.length&&(e.fillIDBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.fillIDBuffer),r.bufferData(r.ARRAY_BUFFER,e.fillIDArray,r.STATIC_DRAW),r.enableVertexAttribArray(6),r.vertexAttribPointer(6,3,r.UNSIGNED_BYTE,!0,0,0),"fill"!==e.subType&&r.vertexAttribDivisor(6,1)),e.vertexBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.vertexBuffer),r.bufferData(r.ARRAY_BUFFER,e.vertexArray,r.STATIC_DRAW),"fill"===e.subType?(r.enableVertexAttribArray(0),r.vertexAttribPointer(0,2,r.SHORT,!1,0,0)):"point"===e.subType||"heatmap"===e.subType?(r.enableVertexAttribArray(1),r.vertexAttribPointer(1,2,r.SHORT,!1,4,0),r.vertexAttribDivisor(1,1),"heatmap"===e.subType&&(e.weightBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.weightBuffer),r.bufferData(r.ARRAY_BUFFER,e.indexArray,r.STATIC_DRAW),r.enableVertexAttribArray(2),r.vertexAttribPointer(2,1,r.FLOAT,!1,4,0),r.vertexAttribDivisor(2,1)),e.typeArray=new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),e.typeBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.typeBuffer),r.bufferData(r.ARRAY_BUFFER,e.typeArray,r.STATIC_DRAW),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,2,r.FLOAT,!1,0,0)):"line"===e.subType&&(r.enableVertexAttribArray(1),r.enableVertexAttribArray(2),r.enableVertexAttribArray(3),r.vertexAttribPointer(1,2,r.SHORT,!1,12,0),r.vertexAttribPointer(2,2,r.SHORT,!1,12,4),r.vertexAttribPointer(3,2,r.SHORT,!1,12,8),r.vertexAttribDivisor(1,1),r.vertexAttribDivisor(2,1),r.vertexAttribDivisor(3,1),e.typeArray=new Float32Array([1,3,4,1,4,2,0,5,6]),e.typeBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.typeBuffer),r.bufferData(r.ARRAY_BUFFER,e.typeArray,r.STATIC_DRAW),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,1,r.FLOAT,!1,0,0)),t.cleanup()):"glyph"===e.type?(e.filterVAO=r.createVertexArray(),e.vao=r.createVertexArray(),r.bindVertexArray(e.filterVAO),e.stepBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.stepBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,1]),r.STATIC_DRAW),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,1,r.FLOAT,!1,0,0),e.glyphFilterBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.glyphFilterBuffer),r.bufferData(r.ARRAY_BUFFER,e.glyphFilterVertices,r.STATIC_DRAW),r.enableVertexAttribArray(1),r.vertexAttribPointer(1,2,r.FLOAT,!1,40,0),r.vertexAttribDivisor(1,1),r.enableVertexAttribArray(2),r.vertexAttribPointer(2,2,r.FLOAT,!1,40,8),r.vertexAttribDivisor(2,1),r.enableVertexAttribArray(3),r.vertexAttribPointer(3,2,r.FLOAT,!1,40,16),r.vertexAttribDivisor(3,1),r.enableVertexAttribArray(4),r.vertexAttribPointer(4,2,r.FLOAT,!1,40,24),r.vertexAttribDivisor(4,1),r.enableVertexAttribArray(5),r.vertexAttribPointer(5,1,r.FLOAT,!1,40,32),r.vertexAttribDivisor(5,1),r.enableVertexAttribArray(6),r.vertexAttribPointer(6,1,r.FLOAT,!1,40,36),r.vertexAttribDivisor(6,1),r.bindVertexArray(e.vao),e.uvBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.uvBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),r.STATIC_DRAW),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,2,r.FLOAT,!1,0,0),e.glyphQuadBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.glyphQuadBuffer),r.bufferData(r.ARRAY_BUFFER,e.glyphQuads,r.STATIC_DRAW),r.enableVertexAttribArray(1),r.vertexAttribPointer(1,2,r.FLOAT,!1,52,0),r.vertexAttribDivisor(1,1),r.enableVertexAttribArray(2),r.vertexAttribPointer(2,2,r.FLOAT,!1,52,8),r.vertexAttribDivisor(2,1),r.enableVertexAttribArray(3),r.vertexAttribPointer(3,2,r.FLOAT,!1,52,16),r.vertexAttribDivisor(3,1),r.enableVertexAttribArray(4),r.vertexAttribPointer(4,2,r.FLOAT,!1,52,24),r.vertexAttribDivisor(4,1),r.enableVertexAttribArray(5),r.vertexAttribPointer(5,2,r.FLOAT,!1,52,32),r.vertexAttribDivisor(5,1),r.enableVertexAttribArray(6),r.vertexAttribPointer(6,2,r.FLOAT,!1,52,40),r.vertexAttribDivisor(6,1),r.enableVertexAttribArray(7),r.vertexAttribPointer(7,1,r.FLOAT,!1,52,48),r.vertexAttribDivisor(7,1),e.glyphColorBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.glyphColorBuffer),r.bufferData(r.ARRAY_BUFFER,e.glyphColors,r.STATIC_DRAW),r.enableVertexAttribArray(8),r.vertexAttribPointer(8,4,r.UNSIGNED_BYTE,!0,4,0),r.vertexAttribDivisor(8,1),t.cleanup()):"raster"!==e.type&&"raster-dem"!==e.type||(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,e.texture),e.image.src,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e.image),r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(272);var l=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"gl",void 0),s(this,"renderer",void 0),s(this,"devicePixelRatio",void 0),s(this,"interactive",void 0),s(this,"depthEpsilon",1/Math.pow(2,16)),s(this,"depthTestState",!1),s(this,"cullState",!1),s(this,"blendState",-1),s(this,"zTestState",-1),s(this,"zLow",0),s(this,"zHigh",1),s(this,"type",void 0),s(this,"clearColorRGBA",[0,0,0,0]),s(this,"featurePoint",new Uint8Array(4)),s(this,"masks",new Map),s(this,"vao",void 0),s(this,"vertexBuffer",void 0),s(this,"interactTexture",void 0),s(this,"stencilBuffer",void 0),s(this,"interactFramebuffer",void 0),s(this,"currentProgram",void 0);var n=r.canvasMultiplier,i=r.interactive;this.gl=e,this.devicePixelRatio=n,this.interactive=i,this._buildInteractFramebuffer();var a=e.getExtension("WEBGL_debug_renderer_info");this.renderer=a?e.getParameter(a.UNMASKED_RENDERER_WEBGL).toLowerCase().replace(/angle \((.+)\)*$/,"$1"):e.getParameter(e.RENDERER)}var e,r;return e=t,(r=[{key:"_buildInteractFramebuffer",value:function(){var t=this.gl,e=this.interactTexture=t.createTexture(),r=this.stencilBuffer=t.createRenderbuffer();this.resizeInteract(),this.interactFramebuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.interactFramebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,r),t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"resize",value:function(){}},{key:"resizeInteract",value:function(){var t=this.gl,e=this.interactive,r=e?t.canvas.width:1,n=e?t.canvas.height:1;t.bindTexture(t.TEXTURE_2D,this.interactTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r,n,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.STENCIL_INDEX8,r,n)}},{key:"getFeatureAtMousePosition",value:function(t,e){var r=this.gl,n=this.interactFramebuffer,i=this.featurePoint;if(r.bindFramebuffer(r.FRAMEBUFFER,n),r.readPixels(t,r.canvas.height-e,1,1,r.RGBA,r.UNSIGNED_BYTE,i),255!==i[3])return null;var a=i[0]+(i[1]<<8)+(i[2]<<16);return i[3]&&a>0?a:null}},{key:"delete",value:function(){var t=this.gl,e=this.vertexBuffer,r=this.vao,n=this.interactTexture,i=this.stencilBuffer,a=this.interactFramebuffer;t.deleteBuffer(e),t.deleteVertexArray(r),t.deleteTexture(n),t.deleteRenderbuffer(i),t.deleteFramebuffer(a),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.canvas.width=1,t.canvas.height=1,t.getExtension("WEBGL_lose_context").loseContext()}},{key:"getMask",value:function(t,e){var r=this.masks;if(r.has(t))return r.get(t);var n=function(t,e){for(var r,n,i,o=[],u=[],s=t+1,l=0,c=0;c<=t;c++){r=8192/t*c;for(var f=0;f<=t;f++)n=8192/t*f,o.push(n,r)}for(var h=0;h<t;h++){0!==h&&u.push((h+1)*s);for(var y=0;y<=t;y++)l=h*s+y,i=(h+1)*s+y,u.push(i,l);u.push(l)}var p={type:"vector",subType:"fill",vertexArray:new Int16Array(o),indexArray:new Uint32Array(u),count:u.length,mode:e.gl.TRIANGLE_STRIP};return a(e,p),p}(e,this);return r.set(t,n),n}},{key:"_createDefaultQuad",value:function(){var t=this.gl;this.vao=t.createVertexArray(),t.bindVertexArray(this.vao),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0),t.bindVertexArray(null)}},{key:"drawQuad",value:function(){var t=this.gl;t.bindVertexArray(this.vao),t.drawArrays(t.TRIANGLE_FAN,0,4)}},{key:"buildSource",value:function(t){return a(this,t)}},{key:"resetViewport",value:function(){var t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height)}},{key:"bindMainBuffer",value:function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"setClearColor",value:function(t){this.clearColorRGBA=t}},{key:"newScene",value:function(){this.enableCullFace(),this.enableStencilTest(),this.disableDepthTest(),this.enableBlend(),this.resetDepthRange(),this.clearScene()}},{key:"clearScene",value:function(){var t=this.gl;this.clearColor(),t.clearStencil(0),t.clearDepth(1),t.clear(t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT|t.COLOR_BUFFER_BIT)}},{key:"clearInteractBuffer",value:function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.interactFramebuffer),t.clearColor(0,0,0,0),t.clearStencil(0),t.clear(t.STENCIL_BUFFER_BIT|t.COLOR_BUFFER_BIT)}},{key:"clearColor",value:function(){var t,e=this.gl;e.clearColor.apply(e,function(t){if(Array.isArray(t))return o(t)}(t=this.clearColorRGBA)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e.blendColor(0,0,0,0)}},{key:"clearColorDepthBuffers",value:function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT)}},{key:"clearColorBuffer",value:function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}},{key:"buildTexture",value:function(t,e,r){var n=this.gl,i=n.createTexture();return n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,r,0,n.RGBA,n.UNSIGNED_BYTE,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),i}},{key:"enableDepthTest",value:function(){var t=this.gl;this.depthTestState||(t.enable(t.DEPTH_TEST),this.depthTestState=!0)}},{key:"disableDepthTest",value:function(){var t=this.gl;this.depthTestState&&(t.disable(t.DEPTH_TEST),this.depthTestState=!1)}},{key:"alwaysDepth",value:function(){var t=this.gl;0!==this.zTestState&&(this.zTestState=0,t.depthFunc(t.ALWAYS))}},{key:"lessDepth",value:function(){var t=this.gl;1!==this.zTestState&&(this.zTestState=1,t.depthFunc(t.LESS))}},{key:"lequalDepth",value:function(){var t=this.gl;2!==this.zTestState&&(this.zTestState=2,t.depthFunc(t.LEQUAL))}},{key:"setDepthRange",value:function(t){var e=this.gl,r=this.zLow,n=this.zHigh,i=1-t*this.depthEpsilon;r===i&&n===i||(e.depthRange(i,i),this.zLow=this.zHigh=i)}},{key:"resetDepthRange",value:function(){var t=this.gl,e=this.zLow,r=this.zHigh;0===e&&1===r||(t.depthRange(0,1),this.zLow=0,this.zHigh=1)}},{key:"wallpaperState",value:function(){var t=this.gl;this.alwaysDepth(),t.stencilFunc(t.EQUAL,0,255)}},{key:"enableCullFace",value:function(){var t=this.gl;this.cullState||(t.enable(t.CULL_FACE),this.cullState=!0)}},{key:"disableCullFace",value:function(){var t=this.gl;this.cullState&&(t.disable(t.CULL_FACE),this.cullState=!1)}},{key:"enableBlend",value:function(){var t=this.gl;t.enable(t.BLEND),this.defaultBlend()}},{key:"disableBlend",value:function(){var t=this.gl;t.disable(t.BLEND)}},{key:"defaultBlend",value:function(){var t=this.gl;0!==this.blendState&&(t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.blendState=0)}},{key:"shadeBlend",value:function(){var t=this.gl;1!==this.blendState&&(t.blendFunc(t.DST_COLOR,t.ZERO),this.blendState=1)}},{key:"inversionBlend",value:function(){var t=this.gl;2!==this.blendState&&(t.blendFunc(t.ONE_MINUS_DST_COLOR,t.ONE_MINUS_SRC_COLOR),this.blendState=2)}},{key:"zeroBlend",value:function(){var t=this.gl;3!==this.blendState&&(t.blendFunc(t.ZERO,t.SRC_COLOR),this.blendState=3)}},{key:"oneBlend",value:function(){var t=this.gl;4!==this.blendState&&(t.blendFunc(t.ONE,t.ONE),this.blendState=4)}},{key:"enableStencilTest",value:function(){var t=this.gl;t.enable(t.STENCIL_TEST)}},{key:"disableStencilTest",value:function(){var t=this.gl;t.disable(t.STENCIL_TEST)}},{key:"stencilFuncAlways",value:function(t){var e=this.gl;e.stencilFunc(e.ALWAYS,t,255)}},{key:"stencilFuncEqual",value:function(t){var e=this.gl;e.stencilFunc(e.EQUAL,t,255)}},{key:"stencilInvert",value:function(){var t=this.gl;t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.INVERT,t.INVERT),t.stencilFunc(t.ALWAYS,0,255)}},{key:"stencilZero",value:function(){var t=this.gl;t.colorMask(!0,!0,!0,!0),t.stencilOp(t.KEEP,t.REPLACE,t.REPLACE),t.stencilFunc(t.NOTEQUAL,0,255)}},{key:"enableMaskTest",value:function(){var t=this.gl;t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1)}},{key:"cleanup",value:function(){var t=this.gl;t.bindVertexArray(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}])&&u(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function h(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(a,t);var e,r,n,i=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(r);if(n){var i=y(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return h(this,t)});function a(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,t,e)).type=2,r._createDefaultQuad(),r}return e=a,Object.defineProperty(e,"prototype",{writable:!1}),e}(l);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&m(t,e)}(o,t);var e,r,n,i,a=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=A(n);if(i){var r=A(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return b(this,t)});function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),w(g(r=a.call(this,t,e)),"elementIndexUint",void 0),w(g(r),"angledInstancedArrays",void 0),w(g(r),"vertexArrayObject",void 0),w(g(r),"blendMinMax",void 0),r.type=1;var n=g(r).gl;return r.elementIndexUint=n.getExtension("OES_element_index_uint"),r.elementIndexUint||console.log('*** Error - "OES_element_index_uint" is not a supported extension'),r.angledInstancedArrays=n.getExtension("ANGLE_instanced_arrays"),r.angledInstancedArrays||console.log('*** Error - "ANGLE_instanced_arrays" is not a supported extension'),r.vertexArrayObject=n.getExtension("OES_vertex_array_object"),r.vertexArrayObject||console.log('*** Error - "OES_vertex_array_object" is not a supported extension'),r.blendMinMax=n.getExtension("EXT_blend_minmax"),r.blendMinMax||console.log('*** Error - "EXT_blend_minmax" is not a supported extension'),r._polyfill(),r._createDefaultQuad(),r}return e=o,(r=[{key:"_polyfill",value:function(){var t=this,e=this.gl;this.vertexArrayObject&&(e.createVertexArray=function(){return t.vertexArrayObject.createVertexArrayOES()},e.bindVertexArray=function(e){return t.vertexArrayObject.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return t.vertexArrayObject.deleteVertexArrayOES(e)}),this.angledInstancedArrays&&(this.gl.vertexAttribDivisor=function(e,r){return t.angledInstancedArrays.vertexAttribDivisorANGLE(e,r)},this.gl.drawArraysInstanced=function(e,r,n,i){return t.angledInstancedArrays.drawArraysInstancedANGLE(e,r,n,i)},this.gl.drawElementsInstanced=function(e,r,n,i,a){return t.angledInstancedArrays.drawElementsInstancedANGLE(e,r,n,i,a)}),this.blendMinMax&&(e.MAX=this.blendMinMax.MAX_EXT)}}])&&d(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(l);function x(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function k(t,e,r,n,i,a,o){try{var u=t[a](o),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,i)}function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(751);var R=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_(this,"context",void 0),_(this,"programs",{}),_(this,"currProgram",void 0),_(this,"dirty",!0),this.context=e,this.context=2===r?new p(e,n):new T(e,n)}var e,n,a,o;return e=t,n=[{key:"delete",value:function(){var t=this.context,e=this.programs;for(var r in e)e[r].delete();t.delete()}},{key:"buildPrograms",value:(a=i().mark((function t(e){var n,a,o,u,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.programs,a=this.context,o=x(e),t.prev=2,o.s();case 4:if((u=o.n()).done){t.next=55;break}s=u.value,t.t0=s,t.next="raster"===t.t0?9:"sensor"===t.t0?13:"fill"===t.t0?17:"line"===t.t0?21:"point"===t.t0?25:"heatmap"===t.t0?29:"shade"===t.t0?33:"glyph"===t.t0?37:"wallpaper"===t.t0?44:"skybox"===t.t0?48:52;break;case 9:return t.next=11,r.e(273).then(r.bind(r,273)).then((function(t){return new t.default(a)}));case 11:return n.raster=t.sent,t.abrupt("break",53);case 13:return t.next=15,r.e(513).then(r.bind(r,513)).then((function(t){return new t.default(a)}));case 15:return n.sensor=t.sent,t.abrupt("break",53);case 17:return t.next=19,r.e(619).then(r.bind(r,619)).then((function(t){return new t.default(a)}));case 19:return n.fill=t.sent,t.abrupt("break",53);case 21:return t.next=23,r.e(709).then(r.bind(r,709)).then((function(t){return new t.default(a)}));case 23:return n.line=t.sent,t.abrupt("break",53);case 25:return t.next=27,r.e(212).then(r.bind(r,212)).then((function(t){return new t.default(a)}));case 27:return n.point=t.sent,t.abrupt("break",53);case 29:return t.next=31,r.e(465).then(r.bind(r,747)).then((function(t){return new t.default(a)}));case 31:return n.heatmap=t.sent,t.abrupt("break",53);case 33:return t.next=35,r.e(638).then(r.bind(r,638)).then((function(t){return new t.default(a)}));case 35:return n.shade=t.sent,t.abrupt("break",53);case 37:return t.next=39,r.e(37).then(r.bind(r,37)).then((function(t){return new t.default(a)}));case 39:return n.glyphFilter=t.sent,t.next=42,r.e(189).then(r.bind(r,189)).then((function(t){return new t.default(a,n.glyphFilter)}));case 42:return n.glyph=t.sent,t.abrupt("break",53);case 44:return t.next=46,r.e(963).then(r.bind(r,963)).then((function(t){return new t.default(a)}));case 46:return n.wallpaper=t.sent,t.abrupt("break",53);case 48:return t.next=50,r.e(329).then(r.bind(r,329)).then((function(t){return new t.default(a)}));case 50:return n.skybox=t.sent,t.abrupt("break",53);case 52:return t.abrupt("break",53);case 53:t.next=4;break;case 55:t.next=60;break;case 57:t.prev=57,t.t1=t.catch(2),o.e(t.t1);case 60:return t.prev=60,o.f(),t.finish(60);case 63:case"end":return t.stop()}}),t,this,[[2,57,60,63]])})),o=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=a.apply(t,e);function o(t){k(i,r,n,o,u,"next",t)}function u(t){k(i,r,n,o,u,"throw",t)}o(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"injectFrameUniforms",value:function(t,e,r){var n=this.programs;for(var i in n)n[i].injectFrameUniforms(t,e,r)}},{key:"useProgram",value:function(t){var e=this.programs[t];return this.currProgram!==t?(this.currProgram=t,e.use()):e.flush(),e}},{key:"resize",value:function(){var t=this.context,e=this.programs.glyphFilter,r=this.programs.heatmap;e&&e.resize(),r&&r.resize(),t.resizeInteract(),t.resetViewport(),this.dirty=!0}},{key:"paint",value:function(t,e,r){var n=this.context,i=t.view,a=t.aspect,o=t.getMatrix("m");this.injectFrameUniforms(o,i,a),this._createTileMasksIDs(r);var u=r.flatMap((function(t){return t.featureGuide.filter((function(t){return"heatmap"!==t.type}))})),s=r.flatMap((function(t){return t.featureGuide.filter((function(t){return"heatmap"===t.type}))}));s.length&&u.push(this.paintHeatmap(s)),u.sort(F);var l,c=x(u.map((function(t){return t.parent?t.parent:t.tile})));try{for(c.s();!(l=c.n()).done;)l.value.setScreenPositions(t)}catch(t){c.e(t)}finally{c.f()}var f=u.filter((function(t){return"glyph"===t.type&&!t.overdraw}));if(f.length&&this.paintGlyphFilter(f),n.bindMainBuffer(),n.newScene(),this.paintMasks(r),e.wallpaper){var h=this.useProgram(e.wallpaper.skybox?"skybox":"wallpaper");h&&h.draw(e.wallpaper)}var y=u.filter((function(t){return t.opaque})).reverse();this.paintFeatures(y,!1,r);var p=u.filter((function(t){return!t.opaque}));this.paintFeatures(p,!1,r),n.cleanup()}},{key:"paintInteractive",value:function(t){var e=t.flatMap((function(t){return t.featureGuide})).sort(F).filter((function(t){return t.interactive})).reverse();e.length&&(this.context.clearInteractBuffer(),this.paintFeatures(e,!0,t))}},{key:"_createTileMasksIDs",value:function(t){var e,r=1,n=x(t);try{for(n.s();!(e=n.n()).done;)e.value.tmpMaskID=r,r++}catch(t){n.e(t)}finally{n.f()}}},{key:"paintMasks",value:function(t){var e=this.context,r=e.gl,n=this.useProgram("fill");e.enableMaskTest(),e.lequalDepth(),r.stencilOp(r.KEEP,r.KEEP,r.REPLACE);var i,a=x(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=o.tmpMaskID,s=o.faceST,l=o.bottom,c=o.top,f=o.sourceData.mask;n.setFaceST(s),n.setTilePos(l,c),r.stencilFunc(r.ALWAYS,u,255),r.bindVertexArray(f.vao),n.draw(f,f)}}catch(t){a.e(t)}finally{a.f()}r.colorMask(!0,!0,!0,!0)}},{key:"paintFeatures",value:function(t,e,r){var n,i,a=this.context.gl,o=-1,u=null,s=x(t);try{for(s.s();!(i=s.n()).done;){var l=i.value,c=l.tile,f=l.parent,h=l.layerIndex,y=l.source,p=l.invert,v=l.faceST,d=l.depthPos,m=l.type,b=l.layerCode,g=l.lch,A=c.tmpMaskID,w=f||c,T=w.bottom,E=w.top;u&&o!==h&&(this.flushInvert(r,n,u),u=null),n=this.useProgram(m),a.stencilFunc(a.EQUAL,A,255),o!==h&&(o=h,b&&n.setLayerCode(b,g),n.setInteractive(e),p&&!u&&(a.colorMask(!1,!1,!1,!1),u=d)),n.setFaceST(v),n.setTilePos(T,E),a.bindVertexArray(y.vao),n.draw(l,y,e)}}catch(t){s.e(t)}finally{s.f()}}},{key:"flushInvert",value:function(t,e,r){var n=this.context.gl;n.colorMask(!0,!0,!0,!0);var i,a=x(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=o.tmpMaskID,s=o.faceST,l=o.bottom,c=o.top,f=o.sourceData.mask;f.depthPos=r,e.setFaceST(s),e.setTilePos(l,c),n.stencilFunc(n.ALWAYS,u,255),n.bindVertexArray(f.vao),e.draw(f,f),f.depthPos=null}}catch(t){a.e(t)}finally{a.f()}}},{key:"paintHeatmap",value:function(t){var e=this.context.gl,r=this.useProgram("heatmap");r.setupTextureDraw();var n,i=x(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a.tile,u=a.parent,s=a.source,l=a.layerCode,c=a.faceST,f=u||o,h=f.bottom,y=f.top;r.setFaceST(c),r.setTilePos(h,y),l&&r.setLayerCode(l),e.bindVertexArray(s.vao),r.drawTexture(a,s)}}catch(t){i.e(t)}finally{i.f()}return r.setupCanvasDraw(),t[0]}},{key:"paintGlyphFilter",value:function(t){var e=this.useProgram("glyphFilter");e.bindQuadFrameBuffer(),this._paintGlyphFilter(e,t,1),e.bindResultFramebuffer(),this._paintGlyphFilter(e,t,2)}},{key:"getScreen",value:function(){var t=this.context.gl,e=t.width,r=t.height,n=t.RGBA,i=t.UNSIGNED_BYTE,a=new Uint8ClampedArray(e*r*4);return t.readPixels(0,0,e,r,n,i,a),a}},{key:"_paintGlyphFilter",value:function(t,e,r){var n=this.context.gl,i=-1;t.setMode(r);var a,o=x(e);try{for(o.s();!(a=o.n()).done;){var u=a.value,s=u.tile,l=u.parent,c=u.layerIndex,f=u.source,h=u.layerCode,y=u.faceST,p=l||s,v=p.bottom,d=p.top;i!==c&&h&&(i=c,t.setLayerCode(h)),t.setFaceST(y),t.setTilePos(v,d),n.bindVertexArray(f.filterVAO),t.draw(u,f,r)}}catch(t){o.e(t)}finally{o.f()}}},{key:"injectGlyphImages",value:function(t,e){this.programs.glyph||this.buildPrograms(new Set(["glyph"])),this.programs.glyph.injectImages(t,e)}},{key:"setColorMode",value:function(t){this.dirty=!0;var e=this.programs;for(var r in e)e[r].updateColorBlindMode=0===t?"none":1===t?"protanopia":2===t?"deutranopia":"tritanopia"}}],n&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function F(t,e){var r=t.layerIndex-e.layerIndex;if(r)return r;var n=0,i=(t.parent?1:0)-(e.parent?1:0);if(i)return i;for(var a=Math.min(t.featureCode.length,e.featureCode.length);0===r&&n<a;)r=t.featureCode[n]-e.featureCode[n],n++;return r}},751:(t,e,r)=>{r.d(e,{Lf:()=>E,n9:()=>m,vc:()=>x});var n=r(249),i=r(122),a=r(263),o=r(50);function u(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=h(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var m=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512;p(this,t),d(this,"id",void 0),d(this,"face",void 0),d(this,"i",void 0),d(this,"j",void 0),d(this,"zoom",void 0),d(this,"size",void 0),d(this,"tmpMaskID",void 0),d(this,"bbox",void 0),d(this,"faceST",void 0),d(this,"corners",void 0),d(this,"bottom",void 0),d(this,"top",void 0),d(this,"division",void 0),d(this,"sourceData",{}),d(this,"featureGuide",[]),d(this,"context",void 0),d(this,"interactiveGuide",new Map),d(this,"rendered",!1);var a=this.zoom=(0,o.fu)(r),u=(0,o.LR)(r,a),s=f(u,3),l=s[0],c=s[1],h=s[2];this.context=e,this.id=r,this.face=l,this.i=c,this.j=h,this.size=n;var y=this.bbox=(0,i.YC)(c,h,a);this.faceST=new Float32Array([l,a,y[2]-y[0],y[0],y[3]-y[1],y[1]]),a>=12&&this._buildCorners(),this._getMaskSource()}var e,r;return e=t,(r=[{key:"delete",value:function(){this.featureGuide=[],this.interactiveGuide=new Map}},{key:"deleteSources",value:function(t){var e,r=c(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;delete this.sourceData[n]}}catch(t){r.e(t)}finally{r.f()}this.featureGuide=this.featureGuide.filter((function(e){var r=e.sourceName.split(":")[0];return!t.includes(r)}))}},{key:"injectParentTile",value:function(t,e){var r,n=this._buildBounds(t),i=c(t.featureGuide);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=e[a.layerIndex].maxzoom;a.maskLayer||this.zoom<=o&&this.featureGuide.push(l(l({},a),{},{tile:this,parent:t,bounds:n}))}}catch(t){i.e(t)}finally{i.f()}var u,s=c(t.interactiveGuide);try{for(s.s();!(u=s.n()).done;){var h=f(u.value,2),y=h[0],p=h[1];this.interactiveGuide.set(y,p)}}catch(t){s.e(t)}finally{s.f()}}},{key:"_buildBounds",value:function(t){for(var e=this.i,r=this.j,n=this.zoom,i=t.zoom,a=1<<n-i,o=0,u=0;n>i;){var s=1<<n-i;e%2!=0&&(o+=8192/s),r%2!=0&&(u+=8192/s),e>>=1,r>>=1,n--}return[0+o,0+u,8192/a+o,8192/a+u]}},{key:"_buildCorners",value:function(){var t=this.face,e=this.bbox;this.corners={topLeft:(0,a.dC)((0,a.Fv)((0,a.FC)(t,e[0],e[3])),6371008.8),topRight:(0,a.dC)((0,a.Fv)((0,a.FC)(t,e[2],e[3])),6371008.8),bottomLeft:(0,a.dC)((0,a.Fv)((0,a.FC)(t,e[0],e[1])),6371008.8),bottomRight:(0,a.dC)((0,a.Fv)((0,a.FC)(t,e[2],e[1])),6371008.8)},this.bottom=new Float32Array(4),this.top=new Float32Array(4)}},{key:"setScreenPositions",value:function(t){if(this.corners){var e=t.eye.map((function(t){return 1e3*t})),r=t.getMatrix("km"),i=this.corners,a=i.bottomLeft,o=i.bottomRight,u=i.topLeft,s=i.topRight,l=f(n.iV(r,a.map((function(t,r){return t-e[r]}))),2),c=l[0],h=l[1],y=f(n.iV(r,o.map((function(t,r){return t-e[r]}))),2),p=y[0],v=y[1],d=f(n.iV(r,u.map((function(t,r){return t-e[r]}))),2),m=d[0],b=d[1],g=f(n.iV(r,s.map((function(t,r){return t-e[r]}))),2),A=g[0],w=g[1];this.bottom[0]=c,this.bottom[1]=h,this.bottom[2]=p,this.bottom[3]=v,this.top[0]=m,this.top[1]=b,this.top[2]=A,this.top[3]=w}}},{key:"flush",value:function(t){var e=t.sourceName;this.featureGuide=this.featureGuide.filter((function(r){var n=r.sourceName.split(":"),i=n.pop();return!(n.join(":")===e&&!t[i]&&r.parent)}))}},{key:"_getMaskSource",value:function(){var t=this.context,e=this.zoom,r=1<<Math.max(Math.min(Math.floor(e/2),4),0),n=this.division=16/r;this.sourceData.mask=t.getMask(r,n)}},{key:"removeLayer",value:function(t){this.featureGuide=this.featureGuide.filter((function(e){return e.layerIndex!==t}));var e,r=c(this.featureGuide);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.layerIndex--,n.depthPos--}}catch(t){r.e(t)}finally{r.f()}}},{key:"reorderLayers",value:function(t){var e,r=c(this.featureGuide);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.layerIndex=t[n.layerIndex],n.depthPos=n.layerIndex+1}}catch(t){r.e(t)}finally{r.f()}}},{key:"injectMaskLayers",value:function(t){var e,r=this.zoom,n=c(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=i.minzoom,o=i.maxzoom,u=i.depthPos,s=i.opaque,l=i.layerIndex,f=i.type,h=i.code,y=i.lch,p=i.paint;if(!(r<a||r>o)){var v={maskLayer:!0,tile:this,faceST:this.faceST,layerIndex:l,source:this.sourceData.mask,sourceName:"mask",subType:"fill",count:this.sourceData.mask.count,type:f,depthPos:u,opaque:s,featureCode:new Float32Array([0]),layerCode:h,lch:y,mode:this.sourceData.mask.mode};1===this.context.type&&p&&(p.color&&(v.color=p.color(null,null,this.zoom).getRGB()),p.opacity&&(v.opacity=[p.opacity(null,null,this.zoom)])),this.featureGuide.push(v)}}}catch(t){n.e(t)}finally{n.f()}}},{key:"injectMaskGeometry",value:function(t,e,r,n){var i=this.sourceData.mask={type:"vector",subType:"fill",vertexArray:t,indexArray:e,radiiArray:r,count:e.length,threeD:!0,mode:this.context.gl.TRIANGLES};this.context.buildSource(this.context,i)}},{key:"injectRaster",value:function(t,e,r,n,i,a){this.featureGuide=this.featureGuide.filter((function(e){return e.rasterSource!==t}));var o=this.id,u=this.size,s=this.sourceData[t]={type:"raster",size:u,image:e};this.context.buildSource(s),i&&a.addSourceData(o,i,t,s);var l,f=c(r);try{for(f.s();!(l=f.n()).done;){var h=l.value,y=h.opacity,p=h.layerIndex,v=h.type,d=n[p],m=d.colorRamp,b=d.depthPos,g=d.code,A={tile:this,faceST:this.faceST,layerIndex:p,colorRamp:m,depthPos:b,source:this.sourceData.mask,rasterSource:t,sourceName:"mask",subType:"fill",type:v,featureCode:new Float32Array([0]),layerCode:g,opacity:y,texture:s.texture};i&&(A.getTextures=function(){return a.getTextures(o,t)}),this.featureGuide.push(A)}}catch(t){f.e(t)}finally{f.f()}}},{key:"injectVectorSourceData",value:function(t,e,r,n,i,a,o){this.featureGuide=this.featureGuide.filter((function(e){return e.sourceName!==t}));for(var s=t.split(":").pop(),l=this.sourceData[t]={type:"vector",subType:s,vertexArray:e,indexArray:r,fillIDArray:n,codeTypeArray:i},c=a.length,h=0;h<c;){var y=void 0;"line"===s&&(y=a[h],h++);var p=f(a.slice(h,h+4),4),v=p[0],d=p[1],m=p[2],b=p[3];h+=4;var g=new Float32Array(b?u(a.slice(h,h+b)):[0]),A=o[v],w=A.type,T=A.invert,x=A.depthPos,E=A.opaque,k=A.code,S=A.lch,_=A.colorRamp,R=A.interactive,F={tile:this,faceST:this.faceST,layerIndex:v,source:l,sourceName:t,count:d,offset:m,type:w,invert:T,cap:y,depthPos:x,opaque:E,featureCode:g,layerCode:k,lch:S,interactive:R,colorRamp:_};if(h+=b,1===this.context.type){var P=g,I=a[h];if(h++,F.featureCode=new Float32Array(I?u(a.slice(h,h+I)):[0]),h+=I,"fill"===s){F.color=[],F.opacity=[];for(var M=P.length/5,O=0;O<M;O++){var B,j=5*O;(B=F.color).push.apply(B,u(P.slice(j,j+4))),F.opacity.push(P[j+4])}}else"line"===s?(F.color=P.slice(0,4),F.width=P[4]):"point"===s?(F.color=P.slice(0,4),F.radius=P[4],F.stroke=P.slice(5,9),F.strokeWidth=P[9],F.opacity=P[10]):"heatmap"===s&&(F.intensity=P[0],F.radius=P[1],F.opacity=P[2])}this.featureGuide.push(F)}this.context.buildSource(l)}},{key:"injectGlyphSourceData",value:function(t,e,r,n,i,a){this.featureGuide=this.featureGuide.filter((function(e){return e.sourceName!==t}));for(var o=this.context,s=this.sourceData[t]={type:"glyph",glyphFilterVertices:e,glyphQuads:r,glyphColors:n},l=i.length,c=0;c<l;){var h=f(i.slice(c,c+7),7),y=h[0],p=h[1],v=h[2],d=h[3],m=h[4],b=h[5],g=h[6];c+=7;var A=a[y],w=A.overdraw,T=A.depthPos,x=A.code,E=A.iconCode,k=A.lch,S=A.interactive,_={tile:this,faceST:this.faceST,layerIndex:y,source:s,sourceName:t,filterOffset:v,filterCount:d,offset:m,count:b,type:"glyph",glyphType:0===p?"text":"icon",depthPos:T,featureCode:new Float32Array(g?u(i.slice(c,c+g)):[0]),layerCode:0===p?x:E,interactive:S,overdraw:w,lch:k};c+=g,1===o.type&&(0===p?(_.size=i[c],_.fill=i.slice(c+1,c+5),_.stroke=i.slice(c+5,c+9),_.strokeWidth=i[c+9],c+=10):(_.size=i[c],c++)),this.featureGuide.push(_)}this.context.buildSource(s)}},{key:"injectInteractiveData",value:function(t,e,r){for(var n,i,a,o=new TextDecoder("utf-8"),u=0,s=e.length;u<s;u+=3)n=e[u],i=e[u+1],a=e[u+2],this.interactiveGuide.set(n,JSON.parse(o.decode(r.slice(i,a))))}},{key:"findInteractiveFeature",value:function(t){if(this.interactiveGuide.has(t))return this.interactiveGuide.get(t)}}])&&v(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),b=(r(272),r(22),r(101));function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,r){return e&&A(t.prototype,e),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(330);var x=function(){function t(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:512;g(this,t),T(this,"style",void 0),T(this,"projector",void 0),T(this,"painter",void 0),T(this,"tileSize",void 0),T(this,"uniforms",{uScale:new Float32Array(2),uBackgroundColor:new Float32Array(4),uHaloColor:new Float32Array(4),uFade1Color:new Float32Array(4),uFade2Color:new Float32Array(4)}),T(this,"skybox",!1),this.style=e,this.projector=r,this.painter=n,this.tileSize=i}return w(t,[{key:"getUniforms",value:function(){var t=!1;if((this.painter.dirty||this.projector.dirty||this.style.dirty)&&(this._updateScale(),this._updateStyle(),t=!0),t)return this.uniforms}},{key:"_updateScale",value:function(){var t=this.projector,e=this.tileSize,r=t.zoom,n=t.aspect,i=t.multiplier,a=e*Math.min(Math.pow(2,r),32768);this.uniforms.uScale[0]=a/(n[0]/i*2),this.uniforms.uScale[1]=a/(n[1]/i*2)}},{key:"_updateStyle",value:function(){var t=this.style.wallpaperStyle;for(var e in t)this.uniforms[e]&&(this.uniforms[e]=t[e].getRGB());this.dirty=!0}}]),t}(),E=function(){function t(e,r,n){g(this,t),T(this,"projector",void 0),T(this,"painter",void 0),T(this,"path",void 0),T(this,"type",void 0),T(this,"size",1024),T(this,"fov",(0,b.Id)(80)),T(this,"angle",(0,b.Id)(40)),T(this,"matrix",void 0),T(this,"skybox",!0);var i=e.skybox,a=e.type,o=e.size;this.path=i,this.type=a,o&&(this.size=o),this.projector=r,this.painter=n}return w(t,[{key:"getMatrix",value:function(){if(!this.matrix||this.painter.dirty){var t=this.projector,e=t.aspect,r=t.lon,i=t.lat,a=n.Ue();n.G3(a,this.fov,e[0]/e[1],1,1e4),n.U1(a,[(0,b.Id)(i),(0,b.Id)(r),this.angle]),n.Jp(a,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n.U_(a),this.matrix=new Float32Array(a)}return this.matrix}}]),t}()},978:(t,e,r)=>{r.d(e,{Z:()=>o});var n=r(345);function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];if(r.push(0),Array.isArray(t)){var a=t.shift();if("data-condition"===a)r[0]+=32,r.push.apply(r,i(u(t,e)));else if("data-range"===a){r[0]+=64;var o=t.shift();"expo"===o&&(r[0]+=1,r.push(t.shift())),t.shift(),r.push.apply(r,i(s(t,e)))}else if("input-range"===a){r[0]+=80;var c=t.shift();if("zoom"===c)r[0]+=0;else if("lon"===c)r[0]+=2;else if("lat"===c)r[0]+=4;else if("angle"===c)r[0]+=6;else{if("pitch"!==c)throw Error("unknown input-range type");r[0]+=8}var f=t.shift();"expo"===f&&(r[0]+=1,r.push(t.shift())),r.push.apply(r,i(s(t,e)))}else{if("feature-state"!==a)throw Error("unknown condition type");r[0]+=96,r.push.apply(r,i(l(t,e)))}}else if(t||0===t)if(isNaN(t)){var h=new n.Z(t);r[0]+=16,r.push.apply(r,i(e?h.getLCH():h.getRGB()))}else r[0]+=16,r.push(t);return r[0]+=r.length<<10,new Float32Array(r)}function u(t,e){for(var r=[],n=1;t.length;){var a=t.shift(),u=t.shift();if(Array.isArray(a))r.push.apply(r,[n].concat(i(o(u,e))));else{if("default"!==a)throw new Error("unkown condition type");r.push.apply(r,[0].concat(i(o(u,e))))}n++}return r}function s(t,e){for(var r=[];t.length;){var n=t.shift(),a=t.shift();r.push.apply(r,[n].concat(i(o(a,e))))}return r}function l(t,e){for(var r=[];t.length;){var n=t.shift(),a="default"===n?0:"hover"===n?1:"active"===n?2:0,u=t.shift();r.push.apply(r,[a].concat(i(o(u,e))))}return r}},820:(t,e,r)=>{r.d(e,{nf:()=>n.Z,yg:()=>a.Z,Iw:()=>i.Z,FQ:()=>o.Z,xX:()=>l,Xf:()=>c.Z});var n=r(177),i=r(373),a=r(978),o=r(725),u=r(345);function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){if(t){if(Array.isArray(t)){var r=t.shift();if("data-condition"===r)return function(t,e){for(var r=[];t.length;)if(Array.isArray(t[0])){var n=t.shift(),i=l(t.shift(),e);r.push({condition:(0,c.Z)(n),result:i})}else"default"===t[0]&&(t.shift(),r.default=l(t.shift(),e));return r.default||(r.default=function(){return null}),function(t,e,n){if(e)for(var i,a=0,o=r.length;a<o;a++)if((i=r[a]).condition(e))return t&&t.push(a+1),i.result(t,e,n);return t&&t.push(0),r.default(t,e,n)}}(t,e);if("data-range"===r)return function(t,e){var r=t.shift(),n=t.shift(),a=1;"expo"===n&&(a=t.shift());for(var o=(0,i.Z)(n,a),u=1,s=t.length;u<s;)t[u]=l(t[u],e),u+=2;return function(e,n,i){var a=n&&n[r]&&!isNaN(n[r])?+n[r]:0;if(a<=t[0])return t[1](e,n,a);if(a>=t[t.length-2])return t[t.length-1](e,n,a);for(var u=0;t[u]<=a;)u+=2;var s=t[u-2],l=t[u-1](e,n,a);if(s===a)return l;var c=t[u],f=t[u+1](e,n,a);return o(a,s,c,l,f)}}(t,e);if("input-range"===r)return function(t,e){t.shift();var r=t.shift(),n=1;"expo"===r&&(n=t.shift());for(var a=(0,i.Z)(r,n),o=1,u=t.length;o<u;)t[o]=l(t[o],e),o+=2;return function(e,r,n){if(n<=t[0])return t[1](e,r,n);if(n>=t[t.length-2])return t[t.length-1](e,r,n);for(var i=0;t[i]<=n;)i+=2;var o=t[i-2],u=t[i-1](e,r,n);if(o===n)return u;var s=t[i],l=t[i+1](e,r,n);return a(n,o,s,u,l)}}(t,e);if("feature-state"===r)return function(t,e){for(;t.length&&"default"!==t[0];)t.shift();var r=l(t="default"===t[0]?t[1]:null,e);return function(t,e,n){return r(t,e,n)}}(t,e);var n=[r].concat(function(t){if(Array.isArray(t))return s(t)}(o=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return function(){return n}}if("color"===e||"stroke"===e||"text-fill"===e||"text-stroke"===e){var a=new u.Z(t);return function(){return a}}return function(){return t}}var o;return function(){return null}}var c=r(433)},272:(t,e,r)=>{r.d(e,{Z:()=>b});var n=r(840),i=r.n(n),a=r(345),o=(r(225),r(751));function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var l=r(820);function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function p(t,e,r,n,i,a,o){try{var u=t[a](o),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,i)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){p(a,n,i,o,u,"next",t)}function u(t){p(a,n,i,o,u,"throw",t)}o(void 0)}))}}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,"map",void 0),m(this,"glType",void 0),m(this,"webworker",!1),m(this,"interactive",!1),m(this,"apiKey",void 0),m(this,"zoom",0),m(this,"minzoom",0),m(this,"maxzoom",20),m(this,"zoomOffset",0),m(this,"minLatPosition",70),m(this,"maxLatRotation",89.99999),m(this,"lon",0),m(this,"lat",0),m(this,"bearing",0),m(this,"pitch",0),m(this,"zNear",.5),m(this,"zFar",1e8),m(this,"sources",{}),m(this,"fonts",{}),m(this,"icons",{}),m(this,"layers",[]),m(this,"mask",void 0),m(this,"rasterLayers",{}),m(this,"wallpaper",void 0),m(this,"wallpaperStyle",void 0),m(this,"clearColor",void 0),m(this,"maskLayers",[]),m(this,"analytics",{}),m(this,"dirty",!0);var n=e.webworker,i=e.apiKey;n&&(this.webworker=!0),this.apiKey=i;var a=(this.map=r).painter.context,o=a.gl,u=a.renderer,s=a.type;this.glType=s,this._buildAnalytics(u,s,o.canvas.width,o.canvas.height)}var e,r,n,s;return e=t,r=[{key:"_buildAnalytics",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.analytics={gpu:t,context:e,language:navigator.language.split("-")[0]||"en",width:r,height:n}}},{key:"buildStyle",value:(s=v(i().mark((function t(e){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this,"string"!=typeof e){t.next=3;break}return t.abrupt("return",_requestStyle(e));case 3:if("object"===y(e)){t.next=5;break}return t.abrupt("return",console.error("style must be an object"));case 5:return r.dirty=!0,e=JSON.parse(JSON.stringify(e)),this._prebuildStyle(e),e["time-series"]&&r._buildTimeSeries(e["time-series"]),this._sendStyleDataToWorkers(e),e.center&&Array.isArray(e.center)&&(r.lon=e.center[0],r.lat=e.center[1]),isNaN(e.zoom)||(r.zoom=e.zoom),isNaN(e.zNear)||(r.zNear=e.zNear),isNaN(e.zFar)||(r.zFar=e.zFar),isNaN(e.minLatPosition)||(r.minLatPosition=e.minLatPosition),isNaN(e.maxLatRotation)||(r.maxLatRotation=e.maxLatRotation),!0===e.noClamp&&(r.noClamp=!0),!isNaN(e.minzoom)&&e.minzoom>=-2&&(r.minzoom=e.minzoom),isNaN(e.maxzoom)||(e.maxzoom<=r.minzoom?r.maxzoom=r.minzoom+1:e.maxzoom<=20&&(r.maxzoom=e.maxzoom)),isNaN(e.bearing)||(r.bearing=e.bearing),isNaN(e.pitch)||(r.pitch=e.pitch),e["zoom-offset"]&&(r.zoomOffset=e["zoom-offset"]),e.sources&&(r.sources=e.sources),e.fonts&&(r.fonts=e.fonts),e.icons&&(r.icons=e.icons),e.wallpaper&&r._buildWallpaper(e.wallpaper),e.layers&&(r.layers=e.layers),t.next=29,r._buildLayers();case 29:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"_requestStyle",value:function(t){var e=this.map,r=this.apiKey,n=this.analytics;this.webworker?postMessage({mapID:e.id,type:"requestStyle",style:t,apiKey:r,analytics:n}):window.S2WorkerPool.requestStyle(e.id,t,r,n)}},{key:"deleteSources",value:function(t){var e,r=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=f(t))){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;delete this.sources[n]}}catch(t){r.e(t)}finally{r.f()}}},{key:"_prebuildStyle",value:function(t){this.maskLayers=[];for(var e=0,r=t.layers.length;e<r;e++)this._prebuildLayer(t.layers[e],e);t.background&&(t.background.skybox?(t.background.size||(t.background.size=1024),t.background.type||(t.background.type="png"),t.background.loadingBackground||(t.background.loadingBackground="rgb(0, 0, 0)")):t.background["background-color"]&&(t.background["fade-1"]||(t.background["fade-1"]="rgb(138, 204, 255)"),t.background["fade-2"]||(t.background["fade-2"]="rgb(217, 255, 255)"),t.background.halo||(t.background.halo="rgb(230, 255, 255)"))),t.mask||(t.mask={}),t.mask.exaggeration||(t.mask.exaggeration=1)}},{key:"_prebuildLayer",value:function(t,e){isNaN(t.minzoom)&&(t.minzoom=0),isNaN(t.maxzoom)&&(t.maxzoom=20),t.layer||(t.layer="default"),"mask"===t.source&&this.maskLayers.push(t),t.interactive&&(this.interactive=!0),t.layout||(t.layout={}),t.paint||(t.paint={}),t.layerIndex=e}},{key:"_sendStyleDataToWorkers",value:function(t){var e=this.apiKey,r=this.analytics,n=t.sources,i=t.fonts,a=t.icons,o=t.layers,u=t.minzoom,s=t.maxzoom,l={glType:this.glType,sources:n,fonts:i,icons:a,layers:o,minzoom:u,maxzoom:s,apiKey:e,analytics:r};this.webworker?postMessage({mapID:this.map.id,type:"style",style:l}):window.S2WorkerPool.injectStyle(this.map.id,l)}},{key:"_buildTimeSeries",value:function(t){var e={},r=new Date(Date.UTC());r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),r.set,r=r.getTime(),e.startTime=g(t["start-date"]||r),e.endTime=g(t["end-date"]||r+162e3),e.speed=t.speed||1,e.pauseDuration=t["pause-duration"]||0,e.loop=t.loop||!1,e.autoPlay=t["auto-play"]||!1,e.state="stop",e.cursor=e.startTime,this.map._buildTimeCache(e)}},{key:"_buildWallpaper",value:function(t){var e=this.map,r=e.painter,n=e.projector;if(t.skybox){var i=this.clearColor=new a.Z(t.loadingBackground).getRGB();r.context.setClearColor(i),this.wallpaper=new o.Lf(t,n,r)}else t["background-color"]&&(this.wallpaper=new o.vc(this,n,r),this.wallpaperStyle={uBackgroundColor:new a.Z(t["background-color"]),uFade1Color:new a.Z(t["fade-1"]),uFade2Color:new a.Z(t["fade-2"]),uHaloColor:new a.Z(t.halo)})}},{key:"_buildLayers",value:(n=v(i().mark((function t(){var e,r,n,a,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=new Set([this.wallpaper&&this.wallpaper.skybox?"skybox":this.wallpaper?"wallpaper":null,"fill"]),r=0,n=this.layers.length;r<n;r++)this._buildLayer(this.layers[r],r+1,e);return t.next=4,this.map.painter.buildPrograms(e);case 4:this.wallpaper&&(a=this.wallpaper.skybox,o=this.map.painter.programs[a?"skybox":"wallpaper"],a&&o.injectImages(this.wallpaper,this.map));case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_buildLayer",value:function(t,e,r){if(t.type,r.add(t.type),t.depthPos=e,(0,l.FQ)(t),this.glType>1){var n=[];for(var i in t.layout)"cap"!==i&&"join"!==i&&n.push.apply(n,c((0,l.yg)(t.layout[i])));for(var o in t.paint)n.push.apply(n,c((0,l.yg)(t.paint[o],t.lch)));n.length&&(t.code=new Float32Array(n)),t.iconPaint&&(t.iconCode=new Float32Array((0,l.yg)(t.iconPaint["icon-size"],t.lch)))}else if(1===this.glType&&"mask"===t.source){for(var s in t.layout)t.layout[s]=(0,l.xX)(t.layout[s],s);for(var f in t.paint)t.paint[f]=(0,l.xX)(t.paint[f],f)}t.colorRamp&&(t.colorRamp=this.map.painter.context.buildTexture(function(t){var e,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Math.round,i=new Uint8ClampedArray(1024);if("string"==typeof t)"sinebow"===t?e=function(t){return a.Z.sinebow(t).getRGB(!1)}:"sinebow-extended"===t&&(e=function(t){return a.Z.sinebowExtended(t).getRGB(!1)});else{for(var o=0,s=t.length;o<s;o+=2){var l=new a.Z(t[o+1]);t[o+1]=r?l.toLCH():l}e=function(e){for(var r=0;e>t[r];)r+=2;return e===t[r]?t[r+1].copy().getRGB(!1):a.Z.interpolate(t[r-1],t[r+1],(e-t[r-2])/(t[r]-t[r-2])).getRGB(!1)}}for(var c=0;c<256;c++){var f=u(e(c/256),4),h=f[0],y=f[1],p=f[2],v=f[3],d=c<<2;i[d]=n(h*v),i[d+1]=n(y*v),i[d+2]=n(p*v),i[d+3]=n(255*v)}return i}(t.colorRamp,t.lch),256,1))}},{key:"addLayer",value:function(t,e,r){var n=this.map.painter,i=new Set,a=this._findLayerIndex(e);this._prebuildLayer(t,a),this.webworker?postMessage({mapID:this.map.id,type:"addLayer",layer:t,index:a,tileRequests:r}):window.S2WorkerPool.addLayer(this.map.id,t,a,r);var o=this.layers;o.splice(a,0,t);for(var u=a+1,s=o.length;u<s;u++){var l=o[u];l.layerIndex++,l.depthPos++}this._buildLayer(t,a+1,i),n.buildPrograms(i),this.dirty=!0}},{key:"removeLayer",value:function(t){var e=this._findLayerIndex(t);this.webworker?postMessage({mapID:this.map.id,type:"removeLayer",index:e}):window.S2WorkerPool.removeLayer(this.map.id,e);var r=this.layers;r.splice(e,1);for(var n=e,i=r.length;n<i;n++){var a=r[n];a.layerIndex--,a.depthPos--}return this.dirty=!0,e}},{key:"reorderLayers",value:function(t){for(var e=this.layers,r=[],n=0,i=Object.entries(t);n<i.length;n++){var a=(l=i[n],c=2,function(t){if(Array.isArray(t))return t}(l)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(l,c)||f(l,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],u=a[1],s=e[+o];s.layerIndex=u,s.depthPos=u+1,r[u]=s}var l,c;this.layers=r,this.webworker?postMessage({mapID:this.map.id,type:"reorderLayers",layerChanges:t}):window.S2WorkerPool.reorderLayers(this.map.id,t),this.dirty=!0}},{key:"requestTiles",value:function(t){if(t){var e=[];t.forEach((function(t){var r=t.id,n=t.face,i=t.i,a=t.j,o=t.zoom,u=t.bbox,s=t.division,l=t.size;e.push({id:r,face:n,i,j:a,zoom:o,bbox:u,division:s,size:l})})),this.webworker?postMessage({mapID:this.map.id,type:"tilerequest",tiles:e}):window.S2WorkerPool.tileRequest(this.map.id,e)}}},{key:"_findLayerIndex",value:function(t){var e=this.layers.length;if("number"==typeof t)return t;if("string"==typeof t)for(var r=0;r<e;r++)if(this.layers[r].name===t)return r;return e}}],r&&d(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){var e=new Date(t);return parseInt(e.getTime()/1e3)}},89:(t,e,r)=>{r.d(e,{Z:()=>p});var n=r(101);function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e,r,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=Math.sin,u=Math.cos,s=Math.atan2,l=Math.sqrt,c=this.λ1=(0,n.Id)(e),f=this.φ1=(0,n.Id)(r),h=this.λ2=(0,n.Id)(i),y=this.φ2=(0,n.Id)(a),p=y-f,v=h-c,d=this.a=o(p/2)*o(p/2)+u(f)*u(y)*o(v/2)*o(v/2);this.δ=2*s(l(d),l(1-d))}var e,r;return e=t,(r=[{key:"intermediatePoint",value:function(t){var e=this.λ1,r=this.λ2,i=this.φ1,a=this.φ2,o=this.δ,u=Math.sin,s=Math.cos,l=Math.atan2,c=Math.sqrt,f=u((1-t)*o)/u(o),h=u(t*o)/u(o),y=f*s(i)*s(e)+h*s(a)*s(r),p=f*s(i)*u(e)+h*s(a)*u(r),v=l(f*u(i)+h*u(a),c(y*y+p*p)),d=l(p,y);return[(0,n.ZY)(d),(0,n.ZY)(v)]}},{key:"distanceTo",value:function(){var t=this.a,e=Math.atan2,r=Math.sqrt;return 2*e(r(t),r(1-t))}}])&&i(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=l(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,t),y(this,"startTime",void 0),y(this,"startLon",void 0),y(this,"startLat",void 0),y(this,"startZoom",void 0),y(this,"startBearing",void 0),y(this,"startPitch",void 0),y(this,"endLon",void 0),y(this,"endLat",void 0),y(this,"endZoom",void 0),y(this,"endBearing",void 0),y(this,"endPitch",void 0),y(this,"deltaLon",void 0),y(this,"deltaLat",void 0),y(this,"deltaZoom",void 0),y(this,"deltaBearing",void 0),y(this,"deltaPitch",void 0),y(this,"speed",void 0),y(this,"duration",2.5),y(this,"velocity",void 0),y(this,"futureOffset",0),y(this,"futureTiles",void 0),y(this,"futureKeys",[]),y(this,"ease",void 0),y(this,"_increment",void 0),y(this,"projector",void 0),this.projector=e,this._setupVariables(r)}var e,r;return e=t,(r=[{key:"_setupVariables",value:function(t){var e=this.projector;t.easing&&this._setEasing(t.easing),t.duration&&(this.duration=t.duration),t.speed&&(this.speed=t.speed);var r=isNaN(t.lon)?e.lon:t.lon,n=isNaN(t.lat)?e.lat:t.lat,i=e.clampZoom(isNaN(t.zoom)?e.zoom:t.zoom),a=isNaN(t.bearing)?e.bearing:t.bearing,o=isNaN(t.pitch)?e.pitch:t.pitch;this.startLon=e.lon,this.startLat=e.lat,this.startZoom=e.zoom,this.startBearing=e.bearing,this.startPitch=e.pitch,this.endLon=r,this.endLat=n,this.endZoom=i,this.endBearing=a,this.endPitch=o,this.deltaLon=r-e.lon,this.deltaLat=n-e.lat,this.deltaZoom=i-e.zoom,this.deltaBearing=a-e.bearing,this.deltaPitch=o-e.pitch}},{key:"_setEasing",value:function(t){"linear"===t?this.ease=v:"ease-in"===t?this.ease=d:"ease-out"===t?this.ease=m:"ease-in-out"===t&&(this.ease=b)}},{key:"increment",value:function(t){var e=this.projector,r=this.futureOffset,n=this.futureKeys,i=this.duration;this.startTime||(this.startTime=t),n.length&&n[0]-r<=t&&this._requestFutureTiles();var a=this._increment(t-this.startTime);if(!Array.isArray(a))return a;var o=s(a,5),u=o[0],l=o[1],c=o[2],f=o[3],h=o[4];return e.setPosition(u,l,c,f,h),t-this.startTime>=i}},{key:"zoomTo",value:function(){var t=this.startLon,e=this.startLat,r=this.startZoom,n=this.deltaLon,i=this.deltaLat,a=this.deltaZoom,o=this.endLon,u=this.endLat,s=this.endZoom,l=this.endBearing,c=this.endPitch,f=this.duration;this._increment=function(h){return h>=f?[o,u,s,l,c]:[m(h,t,n,f),m(h,e,i,f),m(h,r,a,f),l,c]},this._buildFutureTileList()}},{key:"compassTo",value:function(){var t=this.startBearing,e=this.startCompass,r=this.deltaBearing,n=this.deltaCompass,i=this.endLon,a=this.endLat,o=this.endZoom,u=this.endBearing,s=this.endPitch,l=this.duration;this._increment=function(c){return c>=l?[i,a,o,u,s]:[i,a,o,m(c,t,r,l),m(c,e,n,l)]},this._buildFutureTileList()}},{key:"swipeTo",value:function(t,e){var r=this.projector,n=this.duration,i=Math.abs;this._increment=function(a){var o=d(n-a,0,t,n),u=d(n-a,0,e,n);return i(o)<=.5&&i(u)<=.5||(r.onMove(o,u),!1)}}},{key:"easeTo",value:function(){var t=this.startLon,e=this.startLat,r=this.startZoom,n=this.startBearing,i=this.startPitch,o=this.deltaZoom,s=this.deltaBearing,l=this.deltaPitch,c=this.endLon,f=this.endLat,h=this.endZoom,y=this.endBearing,p=this.endPitch,v=this.duration,g=this.ease;if(e===f&&t===c&&r===h&&n===y&&i===p)return!1;var A=new a(t,e,c,f),w=g||(o>0?d:m),T=g||(o>0?m:d),x=g||b;return this._increment=function(t){return t>=v?[c,f,h,y,p]:[].concat(u(A.intermediatePoint(T(t,0,1,v))),[w(t,r,o,v),x(t,n,s,v),x(t,i,l,v)])},this._buildFutureTileList(),!0}},{key:"flyTo",value:function(){var t=this.startLon,e=this.startLat,r=this.startZoom,n=this.startBearing,i=this.startPitch,o=this.deltaBearing,l=this.deltaPitch,c=this.endLon,f=this.endLat,h=this.endZoom,y=this.endBearing,p=this.endPitch,v=this.projector,d=this.duration,m=this.ease;if(e===f&&t===c&&r===h&&n===y&&i===p)return!1;var g=Math.max,A=Math.sqrt,w=Math.log,T=Math.exp,x=Math.abs,E=Math.LN2,k=new a(t,e,c,f),S=1.42,_=v.zoomScale(h-r),R=m||b,F=s(v.aspect,2),P=g(F[0],F[1]),I=P/_,M=1e3*v.radius*k.distanceTo()/19546.010197300708*v.zoomScale(r),O=2.0164,B=function(t){var e=(I*I-P*P+(t?-1:1)*O*O*M*M)/(2*(t?I:P)*O*M);return w(A(e*e+1)-e)},j=function(t){return(T(t)-T(-t))/2},D=function(t){return(T(t)+T(-t))/2},L=B(0),C=function(t){return D(L)/D(L+S*t)},z=function(t){return P*((D(L)*(j(e=L+S*t)/D(e))-j(L))/O)/M;var e},N=(B(1)-L)/S;if(x(M)<1e-6||!isFinite(N)){if(x(P-I)<1e-6)return this.easeTo();var U=I<P?-1:1;N=x(w(I/P))/S,z=function(t){return 0},C=function(t){return T(U*S*t)}}return this.speed&&(this.duration=N/this.speed),this._increment=function(t){if(t>=d)return[c,f,h,y,p];var e=t/d*N,a=z(e),s=1/C(e);return[].concat(u(k.intermediatePoint(a)),[r+w(s)/E,R(t,n,o,d),R(t,i,l,d)])},this._buildFutureTileList(),!0}},{key:"_buildFutureTileList",value:function(){var t,e=this.endLon,r=this.endLat,n=this.endZoom,i=this.endBearing,a=this.endPitch,l=this.projector,c=this.duration,f=new Set(l.map.getTiles().map((function(t){return t.id}))),h={},y=[0,c,c,l.getTilesAtPosition(e,r,n,i,a),0,c,c/2,l.getTilesAtPosition.apply(l,u(this._increment(c/2)))];do{t=!1;var p=s(y.splice(0,4),4),v=p[0],d=p[1],m=p[2],b=p[3];if(b){var g,A=o(b);try{for(A.s();!(g=A.n()).done;){var w=g.value;f.has(w)||(f.add(w),h[m]||(h[m]=[]),h[m].push(w),t=!0)}}catch(t){A.e(t)}finally{A.f()}}if(t&&m!==c){var T=(v+m)/2,x=(m+d)/2;y.push(v,m,T,l.getTilesAtPosition.apply(l,u(this._increment(T))),m,d,x,l.getTilesAtPosition.apply(l,u(this._increment(x))))}}while(y.length);this.futureTiles=h,this.futureKeys=[];for(var E=0,k=Object.keys(h);E<k.length;E++){var S=k[E];this.futureKeys.push(+S)}this.futureKeys=this.futureKeys.sort((function(t,e){return t-e})),this.futureOffset=this.futureKeys[0],this._requestFutureTiles(),this._requestFutureTiles(),this._requestFutureTiles()}},{key:"_requestFutureTiles",value:function(){if(this.futureKeys.length){var t=this.futureKeys,e=this.futureTiles,r=this.projector.map,n=t.shift(),i=e[n];r._createFutureTiles(i),delete e[n]}}}])&&h(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function v(t,e,r,n){return r*t/n+e}function d(t,e,r,n){return 0===t?e:r*Math.pow(2,10*(t/n-1))+e}function m(t,e,r,n){return r*(1-Math.pow(2,-10*t/n))+e}function b(t,e,r,n){return 0===t?e:(t/=n/2)<1?r/2*Math.pow(2,10*(t-1))+e:r/2*(2-Math.pow(2,-10*--t))+e}},243:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t){var e="function"==typeof Map?new Map:void 0;return s=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return l(t,arguments,h(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,t)},s(t)}function l(t,e,r){return l=c()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&f(i,r.prototype),i},l.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Z:()=>p});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(p,t);var e,r,n,s,l=(e=p,r=c(),function(){var t,n=h(e);if(r){var i=h(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return o(this,t)});function p(){var t;i(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return y(u(t=l.call.apply(l,[this].concat(r))),"zoomActive",!1),y(u(t),"mouseActive",!1),y(u(t),"minMovementX",1),y(u(t),"minMovementY",.5),y(u(t),"movementX",0),y(u(t),"movementY",0),y(u(t),"totalMovementX",0),y(u(t),"totalMovementY",0),y(u(t),"touchDeltaX",0),y(u(t),"touchDeltaY",0),y(u(t),"touchDeltaZ",0),y(u(t),"clickEvent",null),y(u(t),"zoom",0),t}return n=p,(s=[{key:"clear",value:function(){this.movementX=0,this.movementY=0,this.totalMovementX=0,this.totalMovementY=0,this.zoom=0}},{key:"onTouchStart",value:function(t){this._setTouchDelta(t),this.mouseActive=!0}},{key:"onTouchEnd",value:function(t){var e=this;this._setTouchDelta(t),Math.abs(this.totalMovementX)<this.minMovementX&&Math.abs(this.totalMovementY)<this.minMovementY&&(this.clickEvent?(clearTimeout(this.clickEvent),this.clickEvent=null,this.dispatchEvent(new Event("doubleClick"))):this.clickEvent=setTimeout((function(){e.clickEvent=null,e.dispatchEvent(new Event("click"))}),175))}},{key:"_setTouchDelta",value:function(t){var e=t.length;if(e){var r=t[0],n=r.clientX,i=r.clientY;this.touchDeltaX=n,this.touchDeltaY=i,e>1&&this.zoomActive?(n=t[e-1].clientX,i=t[e-1].clientY,this.touchDeltaZ=Math.hypot(this.touchDeltaX-n,this.touchDeltaY-i)):this.clear()}else this.onMouseUp()}},{key:"onMouseDown",value:function(){this.mouseActive=!0,this.clear()}},{key:"onMouseUp",value:function(t,e){var r=this;this.mouseActive=!1,Math.abs(this.movementX)>this.minMovementX||Math.abs(this.movementY)>this.minMovementY?this.dispatchEvent(new Event("swipe")):Math.abs(this.totalMovementX)<this.minMovementX&&Math.abs(this.totalMovementY)<this.minMovementY&&(this.clickEvent?(clearTimeout(this.clickEvent),this.clickEvent=null,this.dispatchEvent(new CustomEvent("doubleClick",{detail:{posX:t,posY:e}}))):this.clickEvent=setTimeout((function(){r.clickEvent=null,r.dispatchEvent(new CustomEvent("click",{detail:{posX:t,posY:e}}))}),175))}},{key:"onMouseMove",value:function(t,e){this.mouseActive&&(this.movementX=t,this.movementY=e,this.totalMovementX+=t,this.totalMovementY+=e,this.dispatchEvent(new Event("move")))}},{key:"onTouchMove",value:function(t){var e=t.length,r=t[0],n=r.clientX,i=r.clientY;if(e>1&&this.zoomActive){this.touchDeltaX=n,this.touchDeltaY=i,n=t[e-1].clientX,i=t[e-1].clientY;var a=Math.hypot(this.touchDeltaX-n,this.touchDeltaY-i);this.zoom=2*(this.touchDeltaZ-a),this.dispatchEvent(new Event("zoom")),this.touchDeltaZ=a}else if(this.mouseActive){var o=n-this.touchDeltaX,u=i-this.touchDeltaY;this.movementX=o,this.movementY=u,this.totalMovementX+=o,this.totalMovementY+=u,this.touchDeltaX=n,this.touchDeltaY=i,this.dispatchEvent(new Event("move"))}}}])&&a(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),p}(s(EventTarget))},465:(t,e,r)=>{r.d(e,{Z:()=>U});var n=r(840),i=r.n(n),a=(r(272),r(50)),o=r(22),u=r(751);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function c(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=v(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},p.apply(this,arguments)}function v(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}function d(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){var e="function"==typeof Map?new Map:void 0;return b=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return g(t,arguments,T(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),w(n,t)},b(t)}function g(t,e,r){return g=A()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&w(i,r.prototype),i},g.apply(null,arguments)}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function w(t,e){return w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},w(t,e)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function x(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&w(t,e)}(o,t);var e,r,n,i,a=(e=o,r=A(),function(){var t,n=T(e);if(r){var i=T(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return d(this,t)});function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return h(this,o),x(m(t=a.call(this)),"maxCacheSize",void 0),x(m(t),"order",[]),t.maxCacheSize=e,t}return n=o,(i=[{key:"set",value:function(t,e){for(this.order.unshift(t);this.order.length>this.maxCacheSize;)this.delete(this.order[this.order.length-1]);return p(T(o.prototype),"set",this).call(this,t,e)}},{key:"get",value:function(t){return this.order.splice(this.order.indexOf(t),1),this.order.unshift(t),p(T(o.prototype),"get",this).call(this,t)}},{key:"getBatch",value:function(t){var e,r=[],n=l(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.has(i)&&r.push(this.get(i))}}catch(t){n.e(t)}finally{n.f()}return r}},{key:"delete",value:function(t){this.order.splice(this.order.indexOf(t),1);var e=p(T(o.prototype),"get",this).call(this,t);return e&&"function"==typeof e.delete&&e.delete(),p(T(o.prototype),"delete",this).call(this,t)}},{key:"deleteAll",value:function(){var t,e,r,n=l(this);try{for(n.s();!(t=n.n()).done;){var i=(e=t.value,r=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(e,r)||c(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=(i[0],i[1]);a&&"function"==typeof a.delete&&a.delete()}}catch(t){n.e(t)}finally{n.f()}p(T(o.prototype),"clear",this).call(this),this.order=[]}}])&&y(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),o}(b(Map));function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=F(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},R.apply(this,arguments)}function F(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}function P(t,e){return P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},P(t,e)}function I(t,e){if(e&&("object"===k(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return M(t)}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function B(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&P(t,e)}(o,t);var e,r,n,i,a=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(n);if(i){var r=O(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return I(this,t)});function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),B(M(n=a.call(this)),"camera",void 0),B(M(n),"sources",{}),B(M(n),"lastFrame",void 0),B(M(n),"webworker",void 0),B(M(n),"timeSeries",void 0),n.camera=t,n.webworker=e,n.timeSeries=r,n}return e=o,r=[{key:"addSource",value:function(t,e){var r=e/4;this.sources[t]={interval:e,step:r};var n=this.timeSeries,i=n.startTime,a=n.autoPlay,o=n.state;a&&"stop"===o&&(this.timeSeries.state="play");var u=i-i%e;this._requestTiles(u,t,t)}},{key:"addSourceData",value:function(t,e,r,n){this.set("".concat(t,"#").concat(e,"#").concat(r),n)}},{key:"getTextures",value:function(t,e){var r=e.split(":")[0],n=this.timeSeries,i=n.cursor,a=n.endTime,u=this.sources[r];if(!u)return{};var s=u.step,l=u.interval,c=i-i%l,f=c+l,h=R(O(o.prototype),"get",this).call(this,"".concat(t,"#").concat(c,"#").concat(e)),y=R(O(o.prototype),"get",this).call(this,"".concat(t,"#").concat(f,"#").concat(e));h||this._requestTiles(c,r,e,t),!y&&f<=a&&this._requestTiles(f,r,e,t);var p=(h||{}).texture;return p?{time:(i-c)/s,texture:p,textureNext:(y||{}).texture}:{}}},{key:"animate",value:function(t,e){var r=this.timeSeries;if("stop"!==r.state){this.lastFrame||(this.lastFrame=t);var n=(t-this.lastFrame)/1e3;this.lastFrame=t;var i=r.startTime,a=r.endTime,o=r.speed,u=r.loop;r.cursor===a?u?r.cursor=i:r.state="stop":(r.cursor+=n*o,r.cursor>a&&(r.cursor=a)),e()}}},{key:"setTime",value:function(t){this.timeSeries.cursor=t}},{key:"_requestTiles",value:function(t,e,r,n){var i=this.webworker,a=this.camera,u=n?[a.getTile(n)]:a.getTiles();if(u&&u.length){var s,l=[],c=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return S(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}(u);try{for(c.s();!(s=c.n()).done;){var f=s.value,h="".concat(f.id,"#").concat(t,"#").concat(r);if(!R(O(o.prototype),"has",this).call(this,h)){R(O(o.prototype),"set",this).call(this,h,{});var y=f.id,p=f.face,v=f.i,d=f.j,m=f.zoom,b=f.bbox,g=f.division,A=f.size;l.push({id:y,face:p,i:v,j:d,zoom:m,bbox:b,division:g,size:A,time:t})}}}catch(t){c.e(t)}finally{c.f()}l.length&&(i?postMessage({mapID:a.id,type:"timerequest",tiles:l,sourceNames:[e]}):window.S2WorkerPool.timeRequest(a.id,l,[e]))}}}],r&&_(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(E);function D(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function C(t,e,r,n,i,a,o){try{var u=t[a](o),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,i)}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var U=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),N(this,"style",void 0),N(this,"painter",void 0),N(this,"projector",void 0),N(this,"tileCache",new E),N(this,"timeCache",void 0),N(this,"tilesInView",[]),N(this,"lastTileViewState",[]),N(this,"requestQueue",[]),N(this,"zooming",void 0),N(this,"request",void 0),N(this,"wasDirtyLastFrame",!1),N(this,"webworker",!1),this.projector=new o.Z(e,this)}var e,r,n,s;return e=t,r=[{key:"_resizeCamera",value:function(t,e){t=Math.max(t,1),e=Math.max(e,1),this.projector.resize(t,e),this.painter&&this.painter.resize()}},{key:"_injectData",value:function(t){var e=t.type;"fill"===e||"line"===e||"point"===e||"heatmap"===e?this._injectVectorSourceData(t.sourceName,t.tileID,t.vertexBuffer,t.indexBuffer||t.weightBuffer,t.fillIDBuffer,t.codeTypeBuffer,t.featureGuideBuffer,"heatmap"===e):"mask"===e?this._injectMaskGeometry(t.tileID,t.vertexBuffer,t.indexBuffer,t.radiiBuffer):"raster"===e?this._injectRaster(t.sourceName,t.tileID,t.built,t.image,t.featureGuides,t.time):"glyph"===e?this._injectGlyphSourceData(t.sourceName,t.tileID,t.glyphFilterBuffer,t.glyphQuadBuffer,t.glyphColorBuffer,t.featureGuideBuffer):"glyphimages"===e?this.painter.injectGlyphImages(t.maxHeight,t.images):"interactive"===e?this._injectInteractiveData(t.sourceName,t.tileID,t.interactiveGuideBuffer,t.interactiveDataBuffer):"flush"===e?this._injectFlush(t):"timesource"===e&&this._addTimeSource(t.sourceName,t.interval),this.painter.dirty=!0,this.render()}},{key:"_injectFlush",value:function(t){var e=t.tileID;this.tileCache.has(e)&&this.tileCache.get(e).flush(t)}},{key:"_buildTimeCache",value:function(t){this.parent;var e=this.webworker;this.timeCache=new j(this,e,t)}},{key:"_addTimeSource",value:function(t,e){this.parent,this.webworker;var r=this.timeCache;r&&r.addSource(t,e)}},{key:"_injectMaskGeometry",value:function(t,e,r,n){this.tileCache.has(t)&&this.tileCache.get(t).injectMaskGeometry(new Int16Array(e),new Uint32Array(r),new Float32Array(n),this.style.mask)}},{key:"_injectVectorSourceData",value:function(t,e,r,n,i,a,o){var u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(this.tileCache.has(e)){var s=this.tileCache.get(e);s.injectVectorSourceData(t,new Int16Array(r),u?new Float32Array(n):new Uint32Array(n),new Uint8Array(i),a?new Uint8Array(a):null,new Float32Array(o),this.style.layers)}}},{key:"_injectRaster",value:(n=i().mark((function t(e,r,n,a,o,u){var s,l,c,f,h;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=this.tileCache,l=this.timeCache,c=this.style,f=c.layers,!s.has(r)){t.next=9;break}if(h=s.get(r),n){t.next=8;break}return t.next=7,createImageBitmap(new Blob([a]));case 7:a=t.sent;case 8:h.injectRaster(e,a,o,f,u,l);case 9:case"end":return t.stop()}}),t,this)})),s=function(){var t=this,e=arguments;return new Promise((function(r,i){var a=n.apply(t,e);function o(t){C(a,r,i,o,u,"next",t)}function u(t){C(a,r,i,o,u,"throw",t)}o(void 0)}))},function(t,e,r,n,i,a){return s.apply(this,arguments)})},{key:"_injectGlyphSourceData",value:function(t,e,r,n,i,a){this.tileCache.has(e)&&this.tileCache.get(e).injectGlyphSourceData(t,new Float32Array(r),new Float32Array(n),new Uint8ClampedArray(i),new Float32Array(a),this.style.layers)}},{key:"_injectInteractiveData",value:function(t,e,r,n){this.tileCache.has(e)&&this.tileCache.get(e).injectInteractiveData(t,new Uint32Array(r),new Uint8Array(n))}},{key:"getTile",value:function(t){return this.tileCache.get(t)}},{key:"getTiles",value:function(){if(this.projector.dirty){this.painter.dirty=!0,this.projector.dirty=!1;var t,e,r=[],n=D(t=this.projector.getTilesInView());try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!this.tileCache.has(i)){var a=this._createTile(i);r.push(a)}}}catch(t){n.e(t)}finally{n.f()}return r.length&&this.style.requestTiles(r),this.tilesInView=this.tileCache.getBatch(t),this.tilesInView}return this.tilesInView}},{key:"_createFutureTiles",value:function(t){var e,r=this.tileCache,n=this.painter,i=this.style,a=[],o=D(t);try{for(o.s();!(e=o.n()).done;){var u=e.value;if(!r.has(u)){var s=this._createTile(u);a.push(s)}}}catch(t){o.e(t)}finally{o.f()}n.dirty=!0,i.requestTiles(a)}},{key:"_createTile",value:function(t){var e=this.style,r=new u.n9(this.painter.context,t);if(e.maskLayers&&e.maskLayers.length&&r.injectMaskLayers(e.maskLayers),!(0,a.l6)(t)){var n=(0,a.qm)(t);if(this.tileCache.has(n)){var i=this.tileCache.get(n);r.injectParentTile(i,this.style.layers)}}return this.tileCache.set(t,r),r}},{key:"_fullyRenderedScreen",value:function(){var t,e=!0,r=D(this.getTiles());try{for(r.s();!(t=r.n()).done;)if(!0!==t.value.rendered){e=!1;break}}catch(t){r.e(t)}finally{r.f()}return e}},{key:"_draw",value:function(){var t=this.style,e=this.painter,r=this.projector,n=this.getTiles();(t.dirty||e.dirty||r.dirty)&&(this.wasDirtyLastFrame=!0,e.paint(r,t,n)),t.interactive&&!r.dirty&&this.wasDirtyLastFrame&&(this.wasDirtyLastFrame=!1,e.paintInteractive(n)),e.dirty=!1,t.dirty=!1,r.dirty=!1}}],r&&z(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},22:(t,e,r)=>{r.d(e,{Z:()=>_});var n=r(249),i=r(122),a=r(263),o=r(50);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var c=[(0,o.cL)(0),(0,o.cL)(1),(0,o.cL)(2),(0,o.cL)(3),(0,o.cL)(4),(0,o.cL)(5)];function f(t,e,r,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(t<1)return c;var f,d,m,b,g,A=[],w=[],T=new Set;t<<=0;var x=(0,a.LR)((0,a.mi)(r,s),t),E=u(x,3),k=E[0],S=E[1],_=E[2];A.push((0,o.qm)((0,o.Dh)(k,S,_,t),t)),T.add("".concat(k,"-").concat(S,"-").concat(_)),h(k,t,S,_,T,w);var R=(0,n.iV)(e,[0,0,0])[2];do{var F=w.pop(),P=u(F,3),I=P[0],M=P[1],O=P[2];f=(0,i.YC)(M,O,t),d=(0,n.iV)(e,(0,a.dC)((0,a.Fv)((0,a.FC)(I,f[0],f[3])),l)),m=(0,n.iV)(e,(0,a.dC)((0,a.Fv)((0,a.FC)(I,f[2],f[3])),l)),b=(0,n.iV)(e,(0,a.dC)((0,a.Fv)((0,a.FC)(I,f[0],f[1])),l)),g=(0,n.iV)(e,(0,a.dC)((0,a.Fv)((0,a.FC)(I,f[2],f[1])),l)),y(R,b[2],g[2],d[2],m[2])&&(p(b,g,d,m)||v(b,g,d,m))&&(A.push((0,o.qm)((0,o.Dh)(I,M,O,t),t)),h(I,t,M,O,T,w))}while(w.length);return A.sort((function(t,e){return t>e?1:t<e?-1:0}))}function h(t,e,r,n,a,o){var l,c=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=s(t))){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){u=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}((0,i.kN)(t,r,n,e));try{for(c.s();!(l=c.n()).done;){var f=u(l.value,3),h=f[0],y=f[1],p=f[2],v="".concat(h,"-").concat(y,"-").concat(p);a.has(v)||(a.add(v),o.push([h,y,p]))}}catch(t){c.e(t)}finally{c.f()}}function y(t,e,r,n,i){return e<t||r<t||n<t||i<t}function p(t,e,r,n){return r[0]<=1&&r[0]>=-1&&r[1]<=1&&r[1]>=-1||n[0]<=1&&n[0]>=-1&&n[1]<=1&&n[1]>=-1||t[0]<=1&&t[0]>=-1&&t[1]<=1&&t[1]>=-1||e[0]<=1&&e[0]>=-1&&e[1]<=1&&e[1]>=-1}function v(t,e,r,n){return d(r,t)||d(e,n)||d(t,e)||d(n,r)}function d(t,e){return!!(m(t[0],t[1],e[0],e[1],-1,-1,-1,1)||m(t[0],t[1],e[0],e[1],1,-1,1,1)||m(t[0],t[1],e[0],e[1],-1,-1,1,-1)||m(t[0],t[1],e[0],e[1],-1,1,1,1))}function m(t,e,r,n,i,a,o,u){var s=(u-a)*(r-t)-(o-i)*(n-e);if(!s)return!1;var l=((u-a)*(o-t)+(i-o)*(u-e))/s,c=((e-n)*(o-t)+(r-t)*(u-e))/s;return l>0&&l<1&&c>0&&c<1}var b=.017453292519943295,g=57.29577951308232;function A(t){var e=Math.abs,r=Math.asin;return e(t)>1&&(t=t>1?1:-1),r(t)}function w(t){var e=Math.PI;return(0,Math.abs)(t)<=3.14159265359?t:t-function(t){return t<0?-1:1}(t)*e*2}var T=r(101);function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function S(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),S(this,"map",void 0),S(this,"noClamp",!1),S(this,"radius",6371.0088),S(this,"radii",[6378137,6356752.3,6378137]),S(this,"zTranslateStart",5),S(this,"zTranslateEnd",1.001),S(this,"zoomEnd",5),S(this,"positionalZoom",!0),S(this,"view",new Float32Array(16)),S(this,"aspect",new Float32Array([400,300])),S(this,"matrices",{}),S(this,"eye",[0,0,0]),S(this,"minLatPosition",70),S(this,"maxLatPosition",89.99999),S(this,"prevZoom",0),S(this,"zoom",-1),S(this,"minzoom",0),S(this,"maxzoom",20),S(this,"zoomOffset",0),S(this,"lon",-1),S(this,"lat",-1),S(this,"bearing",0),S(this,"pitch",0),S(this,"zNear",.5),S(this,"zFar",1e8),S(this,"tileSize",768),S(this,"multiplier",1),S(this,"dirty",!0);var n=e.canvasMultiplier,i=e.positionalZoom,a=e.webworker,o=e.noClamp;n&&(this.multiplier=n),!1===i&&(this.positionalZoom=!1),a&&(this.webworker=!0),!0===o&&(this.noClamp=!0),this.map=r}var e,r;return e=t,r=[{key:"reset",value:function(){this.dirty||(this.dirty=!0,this.matrices={})}},{key:"setFeatureState",value:function(t){this.view[6]=t}},{key:"setCurrentFeature",value:function(t){this.view[7]=t}},{key:"setStyleParameters",value:function(t,e){var r=Math.min,n=Math.max,i=t.noClamp,a=t.minLatPosition,o=t.maxLatPosition,u=t.minzoom,s=t.maxzoom,l=t.zoomOffset,c=t.zoom,f=t.lon,h=t.lat,y=t.bearing,p=t.pitch,v=t.zNear,d=t.zFar;this.minzoom=u<-2?-2:u>s?s-1:u>19?19:u,this.maxzoom=s>20?20:s<this.minzoom?this.minzoom+1:s,isNaN(l)||(this.zoomOffset=l),isNaN(o)||(this.maxLatPosition=r(o,this.maxLatPosition)),isNaN(a)||(this.minLatPosition=n(a,this.minLatPosition)),!0===i&&(this.noClamp=!0),this.setCompass(y,p),v&&(this.zNear=v),d&&(this.zFar=d),this.setPosition(e?this.lon:f,e?this.lat:h,c)}},{key:"setPosition",value:function(t,e,r,n,i){this._setLonLat(t,e),isNaN(r)||this._setZoom(r),this.setCompass(n,i)}},{key:"setLonLat",value:function(t,e){this._setLonLat(t,e)}},{key:"setZoom",value:function(t){this._setZoom(t)}},{key:"setCompass",value:function(t,e){var r=0;if(isNaN(t)||(r|=this._setBearing(t)),isNaN(e)||(r|=this._setPitch(e)),r){var n=this.bearing,i=this.pitch;this.webworker?postMessage({type:"updateCompass",bearing:n,pitch:i}):this.map.parent._updateCompass(n,i)}}},{key:"zoomChange",value:function(){var t=this.zoom,e=this.prevZoom,r=Math.floor;return r(t)-r(e)}},{key:"zoomScale",value:function(t){return t||(t=this.zoom),Math.pow(2,t)}},{key:"clampLat",value:function(t){var e=this.maxLatPosition,r=this.minLatPosition,n=this.zoom,i=Math.min,a=Math.max,o=e-r,u=i(r+i(o,o/3*n),e);return a(i(u,t),-u)}},{key:"clampZoom",value:function(t){var e=this.minzoom,r=this.maxzoom;return Math.max(Math.min(t,r),e)}},{key:"clampDeg",value:function(t){for(;t>=180;)t-=360;for(;t<-180;)t+=360;return t}},{key:"resize",value:function(t,e){this.aspect[0]=t,this.aspect[1]=e,this.reset()}},{key:"onZoom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.positionalZoom,i=this.multiplier,a=this.aspect;if(this._setZoom(this.zoom-.003*t),this.prevZoom!==this.zoom&&n&&e&&r){var o=x(a,2),u=o[0],s=o[1],l=e-u/i/2,c=s/i/2-r,f=this.zoom-this.prevZoom+1,h=l*f-l,y=c*f-c;this.onMove(-h,y,3072,1536)}}},{key:"onMove",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2340,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1170,i=this.lon,a=this.lat,o=this.bearing,u=Math.abs,s=Math.max,l=Math.min,c=Math.cos,f=Math.sin,h=Math.PI,y=s(this.zoomScale(),1),p=l(30,1/c(u(this.lat)*h/180));if(o){var v=t*f(o=(0,T.Id)(o))+e*c(o);t=t*c(o)-e*f(o),e=v}this._setLonLat(i-t/(r*y)*360*p,a+e/(n*y)*180)}},{key:"cursorToLonLat",value:function(t,e){var r=this.lon,n=this.lat,i=this.zoom;return function(t,e,r,n,i){t*=b,e*=b;var a=Math.PI,o=Math.sqrt,u=Math.sin,s=Math.cos,l=Math.abs,c=Math.atan2,f=o(r*r+n*n);if(f>i)return[null,null];var h=A(f/i),y=u(e),p=s(e),v=u(h),d=s(h),m=t,T=e,x=l(e)-a/2;return l(f)<=1e-10?[m*g,T*g]:(T=A(d*y+n*v*p/f),[(m=l(x)<=1e-10?w(e>=0?t+c(r,-n):t-c(-r,n)):w(t+c(r*v,f*p*d-n*y*v)))*g,T*g])}(r,n,t,e,this.tileSize*Math.pow(2,i)/2)}},{key:"getMatrix",value:function(t){if(this.matrices[t])return n.d9(this.matrices[t]);var e=this.matrices[t]=this._getMatrix(t);return n.d9(e)}},{key:"getTilesInView",value:function(){var t=this.radius,e=this.zoom,r=this.zoomOffset,n=this.lon,i=this.lat;return f(e+r,this.getMatrix("m"),n,i,t)}},{key:"getTilesAtPosition",value:function(t,e,r,n,i){var a=this.radius;return f(r+this.zoomOffset,this._getMatrix("m",!1,t,e,r,n,i),t,e,a)}},{key:"_setLonLat",value:function(t,e){this.noClamp||(t=this.clampDeg(t),e=this.clampLat(e)),this.lon===t&&this.lat===e||(this.lon=t,this.lat=e,this.view[1]=this.lon,this.view[2]=this.lat,this.reset())}},{key:"_setZoom",value:function(t){t=this.clampZoom(t),this.zoom===t&&this.prevZoom===t||(this.prevZoom=this.zoom,this.zoom=t,this.view[0]=this.zoom,this.reset())}},{key:"_setBearing",value:function(t){return t=this.clampDeg(t),this.bearing!==t&&(this.bearing=t,this.reset(),!0)}},{key:"_setPitch",value:function(t){return this.pitch!==t&&(this.pitch=t,this.reset(),!0)}},{key:"_getMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0;isNaN(r)&&(r=this.lon),isNaN(i)&&(i=this.lat),isNaN(a)&&(a=this.zoom),isNaN(o)&&(o=this.bearing),isNaN(u)&&(u=this.pitch);var s=this._updateEye(e,r,i,a),l=this._getProjectionMatrix(t,a),c=n.zB(s,[0,i>90||i<-90?-1:1,0]);return o&&n.jI(l,(0,T.Id)(o)),"km"===t&&(c[12]=0,c[13]=0,c[14]=0),n.Jp(l,c)}},{key:"_updateEye",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this.radius,o=this.zTranslateEnd,u=this.zTranslateStart,s=this.zoomEnd,l=Math.max((o-u)/s*n+u,o)*i,c=(0,a.dC)((0,a.Fv)((0,a.l7)(e,r)),l);return t&&(this.eye=(0,a.dC)((0,a.Fv)((0,a.l7)(e,r)),l)),c}},{key:"_getProjectionMatrix",value:function(t,e){var r=this.radius,i=this.aspect,a=this.tileSize,o=this.multiplier;isNaN(e)&&(e=this.zoom);var u=n.Ue();"km"===t&&(r*=1e3);var s=r/o/(a*Math.pow(2,e));return n.M5(u,i[0]*s,i[1]*s,1e5),u}}],r&&k(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},249:(t,e,r)=>{function n(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function i(t){var e=new Float32Array(t.length);return t.forEach((function(t,r){e[r]=t})),e}function a(t,e,r,n){return t[0]=1/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1/r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=-1/n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,r,n,i){var a=1/Math.tan(e/2);if(t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){var o=1/(n-i);t[10]=(i+n)*o,t[14]=2*i*n*o}else t[10]=-1,t[14]=-2*n;return t}function u(t,e){var r,n,i,a,o,u,s,l,c,f,h=new Float32Array(16),y=t[0],p=t[1],v=t[2],d=e[0],m=e[1],b=e[2];return s=y,l=p,c=v,r=m*(c*=f=1/Math.hypot(s,l,c))-b*(l*=f),n=b*(s*=f)-d*c,i=d*l-m*s,(f=Math.hypot(r,n,i))?(r*=f=1/f,n*=f,i*=f):(r=0,n=0,i=0),a=l*i-c*n,o=c*r-s*i,u=s*n-l*r,(f=Math.hypot(a,o,u))?(a*=f=1/f,o*=f,u*=f):(a=0,o=0,u=0),h[0]=r,h[1]=a,h[2]=s,h[3]=0,h[4]=n,h[5]=o,h[6]=l,h[7]=0,h[8]=i,h[9]=u,h[10]=c,h[11]=0,h[12]=-(r*y+n*p+i*v),h[13]=-(a*y+o*p+u*v),h[14]=-(s*y+l*p+c*v),h[15]=1,h}function s(t,e){return function(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[4],a=t[5],o=t[6],u=t[7],s=t[8],l=t[9],c=t[10],f=t[11];t[4]=i*n+s*r,t[5]=a*n+l*r,t[6]=o*n+c*r,t[7]=u*n+f*r,t[8]=s*n-i*r,t[9]=l*n-a*r,t[10]=c*n-o*r,t[11]=f*n-u*r}(t,e[0]),function(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[0],a=t[1],o=t[2],u=t[3],s=t[8],l=t[9],c=t[10],f=t[11];t[0]=i*n-s*r,t[1]=a*n-l*r,t[2]=o*n-c*r,t[3]=u*n-f*r,t[8]=i*r+s*n,t[9]=a*r+l*n,t[10]=o*r+c*n,t[11]=u*r+f*n}(t,e[1]),l(t,e[2]),t}function l(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5],c=t[6],f=t[7];return t[0]=i*n+s*r,t[1]=a*n+l*r,t[2]=o*n+c*r,t[3]=u*n+f*r,t[4]=s*n-i*r,t[5]=l*n-a*r,t[6]=c*n-o*r,t[7]=f*n-u*r,t}function c(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],y=t[11],p=t[12],v=t[13],d=t[14],m=t[15],b=e[0],g=e[1],A=e[2],w=e[3];return t[0]=b*r+g*o+A*c+w*p,t[1]=b*n+g*u+A*f+w*v,t[2]=b*i+g*s+A*h+w*d,t[3]=b*a+g*l+A*y+w*m,b=e[4],g=e[5],A=e[6],w=e[7],t[4]=b*r+g*o+A*c+w*p,t[5]=b*n+g*u+A*f+w*v,t[6]=b*i+g*s+A*h+w*d,t[7]=b*a+g*l+A*y+w*m,b=e[8],g=e[9],A=e[10],w=e[11],t[8]=b*r+g*o+A*c+w*p,t[9]=b*n+g*u+A*f+w*v,t[10]=b*i+g*s+A*h+w*d,t[11]=b*a+g*l+A*y+w*m,b=e[12],g=e[13],A=e[14],w=e[15],t[12]=b*r+g*o+A*c+w*p,t[13]=b*n+g*u+A*f+w*v,t[14]=b*i+g*s+A*h+w*d,t[15]=b*a+g*l+A*y+w*m,t}function f(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],h=t[11],y=t[12],p=t[13],v=t[14],d=t[15],m=e*o-r*a,b=e*u-n*a,g=e*s-i*a,A=r*u-n*o,w=r*s-i*o,T=n*s-i*u,x=l*p-c*y,E=l*v-f*y,k=l*d-h*y,S=c*v-f*p,_=c*d-h*p,R=f*d-h*v,F=m*R-b*_+g*S+A*k-w*E+T*x;return F?(F=1/F,t[0]=(o*R-u*_+s*S)*F,t[1]=(n*_-r*R-i*S)*F,t[2]=(p*T-v*w+d*A)*F,t[3]=(f*w-c*T-h*A)*F,t[4]=(u*k-a*R-s*E)*F,t[5]=(e*R-n*k+i*E)*F,t[6]=(v*g-y*T-d*b)*F,t[7]=(l*T-f*g+h*b)*F,t[8]=(a*_-o*k+s*x)*F,t[9]=(r*k-e*_-i*x)*F,t[10]=(y*w-p*g+d*m)*F,t[11]=(c*g-l*w-h*m)*F,t[12]=(o*E-a*S-u*x)*F,t[13]=(e*S-r*E+n*x)*F,t[14]=(p*b-y*A-v*m)*F,t[15]=(l*A-c*b+f*m)*F,t):null}function h(t,e){var r=function(t,e){var r=[];return r.push(t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]),r.push(t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]),r.push(t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]),r.push(t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]),r}(t,e);return[r[0]/r[3],r[1]/r[3],r[2]/r[3]]}r.d(e,{Ue:()=>n,d9:()=>i,M5:()=>a,G3:()=>o,zB:()=>u,U1:()=>s,jI:()=>l,Jp:()=>c,U_:()=>f,iV:()=>h})},50:(t,e,r)=>{r.d(e,{cL:()=>u,Dh:()=>s,LR:()=>l,l6:()=>c,fu:()=>f,qm:()=>h}),r(263);for(var n=[],i=[],a=0;a<4;a++)o(0,0,0,a,0,a);function o(t,e,r,a,u,s){var l=[1,0,0,3];if(4===t){var c=(e<<4)+r;n[(c<<2)+a]=BigInt((u<<2)+s),i[(u<<2)+a]=BigInt((c<<2)+s)}else{t++,r<<=1,u<<=2;var f=[[0,1,3,2],[0,2,3,1],[3,2,0,1],[3,1,0,2]][s];o(t,(e<<=1)+(f[0]>>1),r+(1&f[0]),a,u,s^l[0]),o(t,e+(f[1]>>1),r+(1&f[1]),a,u+1,s^l[1]),o(t,e+(f[2]>>1),r+(1&f[2]),a,u+2,s^l[2]),o(t,e+(f[3]>>1),r+(1&f[3]),a,u+3,s^l[3])}}function u(t){return(BigInt(t)<<61n)+(1n<<60n)}function s(t,e,r,i){var a=BigInt(t),o=BigInt(e),u=BigInt(r);if(void 0!==i){var s=BigInt(i);o<<=30n-s,u<<=30n-s}for(var l=a<<60n,c=1n&a,f=7n;f>=0n;f--){var y=4n*f;c+=(o>>y&15n)<<6n,l|=(c=n[c+=(u>>y&15n)<<2n])>>2n<<8n*f,c&=3n}var p=2n*l+1n;return void 0!==i?h(p,i):p}function l(t,e){for(var r=0n,n=0n,a=t>>61n,o=1n&a,u=7n;u>=0n;u--)r+=(o=i[o+=(t>>8n*u+1n&(1n<<2n*(7n===u?2n:4n))-1n)<<2n])>>6n<<4n*u,n+=(o>>2n&15n)<<4n*u,o&=3n;return 1229782938247303424n&t&~t+1n&&(o^=1n),void 0!==e&&(r>>=30n-(e=BigInt(e)),n>>=30n-e),[Number(a),Number(r),Number(n),Number(o)]}function c(t){return!(t&(1n<<60n)-1n)}function f(t){for(var e=0,r=0n;!(t&1n<<r)&&r<60n;)r+=2n,e++;return 30-e}function h(t,e){var r=void 0!==e?1n<<2n*(30n-BigInt(e)):(t&~t+1n)<<2n;return t&~r+1n|r}},122:(t,e,r)=>{r.d(e,{nV:()=>u,NR:()=>s,tp:()=>l,_x:()=>c,UO:()=>f,d9:()=>h,Q7:()=>y,YC:()=>p,kN:()=>v});var n=r(101);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function s(t){return t>=0?.5*Math.sqrt(1+3*t):1-.5*Math.sqrt(1-3*t)}function l(t){return(0,Math.max)(0,(0,Math.min)(1073741823,(0,Math.floor)(1073741824*t)))}function c(t,e,r){switch(t){case 0:return[e,r,1];case 1:return[1,r,-e];case 2:return[-r,1,-e];case 3:return[-r,-e,-1];case 4:return[-1,-e,r];default:return[e,-1,r]}}function f(t){var e,r=function(t){var e=t.map((function(t){return Math.abs(t)})),r=e[0]>e[1]?e[0]>e[2]?0:2:e[1]>e[2]?1:2;return t[r]<0&&(r+=3),r}(t);return[r].concat((e=function(t,e){var r=i(e,3),n=r[0],a=r[1],o=r[2];switch(t){case 0:return[a/n,o/n];case 1:return[-n/a,o/a];case 2:return[-n/o,-a/o];case 3:return[o/n,a/n];case 4:return[o/a,-n/a];default:return[-a/o,-n/o]}}(r,t),function(t){if(Array.isArray(t))return o(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}function h(t,e){return t=(0,n.Id)(t),e=(0,n.Id)(e),[Math.cos(e)*Math.cos(t),Math.cos(e)*Math.sin(t),Math.sin(e)]}function y(t,e){return t=(0,n.Id)(t),e=(0,n.Id)(e),[Math.cos(e)*Math.sin(t),Math.sin(e),Math.cos(e)*Math.cos(t)]}function p(t,e,r){var n=2/(1<<r)*.5;return[n*t,n*e,n*(t+1),n*(e+1)]}function v(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,i=1<<30-n;return 30!==n&&(e<<=30-n,r<<=30-n),[d(t,e,r-i,n,r-i>=0),d(t,e+i,r,n,e+i<i),d(t,e,r+i,n,r+i<i),d(t,e-i,r,n,e-i>=0)]}function d(t,e,r,n,a){if(a)return[t,e>>30-n,r>>30-n];var o=Math.max,u=Math.min,s=1073741824;e=o(-1,u(s,e)),r=o(-1,u(s,r));var c=1/s,h=1.0000000000000002,y=f(function(t,e,r){switch(t){case 0:return[1,e,r];case 1:return[-e,1,r];case 2:return[-e,-r,1];case 3:return[-1,-r,-e];case 4:return[r,-1,-e];default:return[r,e,-1]}}(t,o(-h,u(h,c*(2*(e-536870912)+1))),o(-h,u(h,c*(2*(r-536870912)+1))))),p=i(y,3),v=p[0],d=p[1],m=p[2];return[v,l(.5*(d+1))>>30-n,l(.5*(m+1))>>30-n]}},263:(t,e,r)=>{r.d(e,{mi:()=>o,l7:()=>u,FC:()=>s,LR:()=>l,dC:()=>c,Fv:()=>f});var n=r(122);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,u=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){u=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){return(0,n.d9)(t,e)}function u(t,e){return(0,n.Q7)(t,e)}function s(t,e,r){var i=[(0,n.nV)(e),(0,n.nV)(r)];return function(t,e,r){return(0,n._x)(t,e,r)}(t,i[0],i[1])}function l(t,e){var r=i(function(t){var e=function(t){return(0,n.UO)(t)}(t),r=i(e,3),a=r[0],o=r[1],u=r[2];return[a,(0,n.NR)(o),(0,n.NR)(u)]}(t),3),a=r[0],o=r[1],u=r[2],s=(0,n.tp)(o),l=(0,n.tp)(u);return e&&(s>>=30-e,l>>=30-e),[a,s,l]}function c(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t}function f(t){var e=function(t){var e=i(t,3),r=e[0],n=e[1],a=e[2];return Math.sqrt(r*r+n*n+a*a)}(t);return t[0]/=e,t[1]/=e,t[2]/=e,t}r(50)},101:(t,e,r)=>{function n(t){return 180*t/Math.PI}function i(t){return t*Math.PI/180}r.d(e,{ZY:()=>n,Id:()=>i})}}]);