"use strict";(this.webpackChunk=this.webpackChunk||[]).push([[329],{53:(t,e,r)=>{function i(t,e,r){var i=t.createShader(r);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(i);return console.log("*** Error compiling shader '".concat(i,"': ").concat(o)),t.deleteShader(i),null}return i}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Z:()=>c});var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"vertexShader",void 0),s(this,"fragmentShader",void 0),s(this,"radii",!1),s(this,"context",void 0),s(this,"gl",void 0),s(this,"glProgram",void 0),s(this,"uMatrix",void 0),s(this,"uAspect",void 0),s(this,"uMode",void 0),s(this,"u3D",void 0),s(this,"uLCH",void 0),s(this,"uInteractive",void 0),s(this,"uFaceST",void 0),s(this,"uBottom",void 0),s(this,"uTop",void 0),s(this,"uInputs",void 0),s(this,"uLayerCode",void 0),s(this,"uFeatureCode",void 0),s(this,"uDevicePixelRatio",void 0),s(this,"updateColorBlindMode","none"),s(this,"updateMatrix",null),s(this,"updateInputs",null),s(this,"updateAspect",null),s(this,"curMode",-1),s(this,"threeD",void 0),s(this,"LCH",void 0),s(this,"colorBlind",void 0),s(this,"interactive",void 0),this.context=e;var r=e.gl;this.gl=r,this.glProgram=r.createProgram()}var e,r;return e=t,r=[{key:"buildShaders",value:function(t,e){var r=this.gl,o=this.glProgram;this.setupAttributes(t.attributes);var n=this.vertexShader=i(r,t.source,r.VERTEX_SHADER),u=this.fragmentShader=i(r,e.source,r.FRAGMENT_SHADER);if(!n||!u)throw Error("missing shaders");if(r.attachShader(o,n),r.attachShader(o,u),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS))throw Error(r.getProgramInfoLog(o));this.setupUniforms(a(a({},t.uniforms),e.uniforms))}},{key:"setupUniforms",value:function(t){for(var e=this.gl,r=this.glProgram,i=0,n=Object.entries(t);i<n.length;i++){var a=(c=n[i],l=2,function(t){if(Array.isArray(t))return t}(c)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,o,n=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(i=r.next()).done)&&(n.push(i.value),!e||n.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return n}}(c,l)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(c,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],s=a[1];this[u]=e.getUniformLocation(r,s)}var c,l}},{key:"setupAttributes",value:function(t){var e=this.gl,r=this.glProgram,i=e.attributeLocations;if(i)for(var o in i)e.bindAttribLocation(r,i[o],t[o])}},{key:"delete",value:function(){var t=this.gl,e=this.vertexShader,r=this.fragmentShader;t.deleteShader(e),t.deleteShader(r)}},{key:"use",value:function(){var t=this.gl,e=this.glProgram;t.useProgram(e),this.flush()}},{key:"injectFrameUniforms",value:function(t,e,r){this.updateMatrix=t,this.updateInputs=e,this.updateAspect=r}},{key:"flush",value:function(){this.updateColorBlindMode&&this.setColorBlindMode(this.updateColorBlindMode),this.updateMatrix&&this.setMatrix(this.updateMatrix),this.updateInputs&&this.setInputs(this.updateInputs),this.updateAspect&&this.setAspect(this.updateAspect)}},{key:"setDevicePixelRatio",value:function(t){this.gl.uniform1f(this.uDevicePixelRatio,t)}},{key:"setColorBlindMode",value:function(t){this.gl.uniform1f(this.uColorBlind,"protanopia"===t?1:"deutranopia"===t?2:"tritanopia"===t?3:0),this.updateColorBlindMode=null}},{key:"setMatrix",value:function(t){this.gl.uniformMatrix4fv(this.uMatrix,!1,t),this.updateMatrix=null}},{key:"setInputs",value:function(t){this.gl.uniform1fv(this.uInputs,t,0,t.length),this.updateInputs=null}},{key:"setAspect",value:function(t){this.uAspect&&this.gl.uniform2fv(this.uAspect,t),this.updateAspect=null}},{key:"setFaceST",value:function(t){this.gl.uniform1fv(this.uFaceST,t,0,t.length)}},{key:"setTilePos",value:function(t,e){t&&this.gl.uniform4fv(this.uBottom,t,0,4),e&&this.gl.uniform4fv(this.uTop,e,0,4)}},{key:"setLayerCode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.gl;t.length&&r.uniform1fv(this.uLayerCode,t,0,t.length),this.uLCH&&this.LCH!==e&&(this.LCH=e,r.uniform1i(this.uLCH,~~e))}},{key:"setInteractive",value:function(t){var e=this.gl;this.interactive!==t&&(this.interactive=t,e.uniform1i(this.uInteractive,t))}},{key:"setFeatureCode",value:function(t){t&&t.length&&this.gl.uniform1fv(this.uFeatureCode,t)}},{key:"set3D",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.u3D&&this.threeD!==t&&(this.threeD=t,this.gl.uniform1i(this.u3D,t))}},{key:"setMode",value:function(t){this.uMode&&this.curMode!==t&&(this.curMode=t,this.gl.uniform1i(this.uMode,t))}},{key:"draw",value:function(t){}}],r&&u(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},329:(t,e,r)=>{r.r(e),r.d(e,{default:()=>v});var i=r(53);r(225);const o={source:"precision highp float;attribute vec4 aA;uniform mat4 uB;varying vec4 aC;void main(){aC=uB*aA;gl_Position=aA;gl_Position.z=1.0;}",uniforms:{uMatrix:"uB"},attributes:{aPos:"aA",vPos:"aC"}},n={source:"precision highp float;uniform samplerCube uD;varying vec4 aC;void main(){gl_FragColor=textureCube(uD,normalize(aC.xyz/aC.w));}",uniforms:{uSkybox:"uD"},attributes:{vPos:"aC"}},a={source:"#version 300 es\nprecision highp float;layout(location=0) in vec4 aA;uniform mat4 uB;out vec4 aC;void main(){aC=uB*aA;gl_Position=aA;gl_Position.z=1.;}",uniforms:{uMatrix:"uB"},attributes:{aPos:"aA",vPos:"aC"}},u={source:"#version 300 es\nprecision highp float;in vec4 aC;out vec4 aD;uniform samplerCube uE;void main(){aD=texture(uE,normalize(aC.xyz/aC.w));}",uniforms:{uSkybox:"uE"},attributes:{vPos:"aC",fragColor:"aD"}};function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function f(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&l(t,e)}(y,t);var e,r,i,s,v=(i=y,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(i);if(s){var r=d(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return f(this,t)});function y(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);var r=t.gl,i=t.type;return p(h(e=v.call(this,t)),"aPos",void 0),p(h(e),"cubeMap",void 0),p(h(e),"facesReady",0),p(h(e),"renderable",!1),1===i?e.buildShaders(o,n):e.buildShaders(a,u),e.cubeMap=r.createTexture(),e}return e=y,(r=[{key:"injectImages",value:function(t,e){for(var r=this,i=this,o=i.gl,n=t.path,a=t.type,u=t.size,s=function(t){fetch("".concat(n,"/").concat(u,"/").concat(t,".").concat(a)).then((function(t){return 200!==t.status&&206!==t.status?null:t.blob()})).then((function(n){n&&createImageBitmap(n).then((function(n){o.bindTexture(o.TEXTURE_CUBE_MAP,i.cubeMap),o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,n),i.facesReady++,6===i.facesReady&&(o.generateMipmap(o.TEXTURE_CUBE_MAP),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),r.renderable=!0,e.projector.reset(),e.render())}))}))},c=0;c<6;c++)s(c)}},{key:"draw",value:function(t){var e=this.gl,r=this.context;if(this.renderable){r.wallpaperState();var i=t.getMatrix();e.uniformMatrix4fv(this.uMatrix,!1,i),r.drawQuad()}}}])&&c(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),y}(i.Z)}}]);