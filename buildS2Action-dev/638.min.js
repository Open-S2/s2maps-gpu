"use strict";(this.webpackChunk=this.webpackChunk||[]).push([[638],{53:(e,t,o)=>{function r(e,t,o){var r=e.createShader(o);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);return console.log("*** Error compiling shader '".concat(r,"': ").concat(i)),e.deleteShader(r),null}return r}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function u(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function n(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?u(Object(o),!0).forEach((function(t){s(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o.d(t,{Z:()=>c});var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"vertexShader",void 0),s(this,"fragmentShader",void 0),s(this,"radii",!1),s(this,"context",void 0),s(this,"gl",void 0),s(this,"glProgram",void 0),s(this,"uMatrix",void 0),s(this,"uAspect",void 0),s(this,"uMode",void 0),s(this,"u3D",void 0),s(this,"uLCH",void 0),s(this,"uInteractive",void 0),s(this,"uFaceST",void 0),s(this,"uBottom",void 0),s(this,"uTop",void 0),s(this,"uInputs",void 0),s(this,"uLayerCode",void 0),s(this,"uFeatureCode",void 0),s(this,"uDevicePixelRatio",void 0),s(this,"updateColorBlindMode","none"),s(this,"updateMatrix",null),s(this,"updateInputs",null),s(this,"updateAspect",null),s(this,"curMode",-1),s(this,"threeD",void 0),s(this,"LCH",void 0),s(this,"colorBlind",void 0),s(this,"interactive",void 0),this.context=t;var o=t.gl;this.gl=o,this.glProgram=o.createProgram()}var t,o;return t=e,o=[{key:"buildShaders",value:function(e,t){var o=this.gl,i=this.glProgram;this.setupAttributes(e.attributes);var u=this.vertexShader=r(o,e.source,o.VERTEX_SHADER),a=this.fragmentShader=r(o,t.source,o.FRAGMENT_SHADER);if(!u||!a)throw Error("missing shaders");if(o.attachShader(i,u),o.attachShader(i,a),o.linkProgram(i),!o.getProgramParameter(i,o.LINK_STATUS))throw Error(o.getProgramInfoLog(i));this.setupUniforms(n(n({},e.uniforms),t.uniforms))}},{key:"setupUniforms",value:function(e){for(var t=this.gl,o=this.glProgram,r=0,u=Object.entries(e);r<u.length;r++){var n=(c=u[r],l=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var r,i,u=[],n=!0,a=!1;try{for(o=o.call(e);!(n=(r=o.next()).done)&&(u.push(r.value),!t||u.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return u}}(c,l)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?i(e,t):void 0}}(c,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],s=n[1];this[a]=t.getUniformLocation(o,s)}var c,l}},{key:"setupAttributes",value:function(e){var t=this.gl,o=this.glProgram,r=t.attributeLocations;if(r)for(var i in r)t.bindAttribLocation(o,r[i],e[i])}},{key:"delete",value:function(){var e=this.gl,t=this.vertexShader,o=this.fragmentShader;e.deleteShader(t),e.deleteShader(o)}},{key:"use",value:function(){var e=this.gl,t=this.glProgram;e.useProgram(t),this.flush()}},{key:"injectFrameUniforms",value:function(e,t,o){this.updateMatrix=e,this.updateInputs=t,this.updateAspect=o}},{key:"flush",value:function(){this.updateColorBlindMode&&this.setColorBlindMode(this.updateColorBlindMode),this.updateMatrix&&this.setMatrix(this.updateMatrix),this.updateInputs&&this.setInputs(this.updateInputs),this.updateAspect&&this.setAspect(this.updateAspect)}},{key:"setDevicePixelRatio",value:function(e){this.gl.uniform1f(this.uDevicePixelRatio,e)}},{key:"setColorBlindMode",value:function(e){this.gl.uniform1f(this.uColorBlind,"protanopia"===e?1:"deutranopia"===e?2:"tritanopia"===e?3:0),this.updateColorBlindMode=null}},{key:"setMatrix",value:function(e){this.gl.uniformMatrix4fv(this.uMatrix,!1,e),this.updateMatrix=null}},{key:"setInputs",value:function(e){this.gl.uniform1fv(this.uInputs,e,0,e.length),this.updateInputs=null}},{key:"setAspect",value:function(e){this.uAspect&&this.gl.uniform2fv(this.uAspect,e),this.updateAspect=null}},{key:"setFaceST",value:function(e){this.gl.uniform1fv(this.uFaceST,e,0,e.length)}},{key:"setTilePos",value:function(e,t){e&&this.gl.uniform4fv(this.uBottom,e,0,4),t&&this.gl.uniform4fv(this.uTop,t,0,4)}},{key:"setLayerCode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.gl;e.length&&o.uniform1fv(this.uLayerCode,e,0,e.length),this.uLCH&&this.LCH!==t&&(this.LCH=t,o.uniform1i(this.uLCH,~~t))}},{key:"setInteractive",value:function(e){var t=this.gl;this.interactive!==e&&(this.interactive=e,t.uniform1i(this.uInteractive,e))}},{key:"setFeatureCode",value:function(e){e&&e.length&&this.gl.uniform1fv(this.uFeatureCode,e)}},{key:"set3D",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.u3D&&this.threeD!==e&&(this.threeD=e,this.gl.uniform1i(this.u3D,e))}},{key:"setMode",value:function(e){this.uMode&&this.curMode!==e&&(this.curMode=e,this.gl.uniform1i(this.uMode,e))}},{key:"draw",value:function(e){}}],o&&a(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},638:(e,t,o)=>{o.r(t),o.d(t,{default:()=>h});var r=o(53);const i={source:"precision highp float;attribute vec2 aA;uniform vec2 uB;uniform float uC[16];uniform float uD;varying vec2 aE;uniform float uF[6];uniform vec4 uG;uniform vec4 uH;uniform mat4 uI;float STtoUV(float s){if(s>=0.5) return(1./3.)*(4.*s*s-1.);else return(1./3.)*(1.-4.*(1.-s)*(1.-s));}vec4 STtoXYZ(in vec2 st){st/=8192.;int face=int(uF[0]);vec3 xyz;vec2 uv=vec2(STtoUV(uF[2]*st.x+uF[3]),STtoUV(uF[4]*st.y+uF[5]) );if(face==0) xyz=vec3(uv.x,uv.y,1.);else if(face==1) xyz=vec3(1.,uv.y,-uv.x);else if(face==2) xyz=vec3(-uv.y,1.,-uv.x);else if(face==3) xyz=vec3(-uv.y,-uv.x,-1.);else if(face==4) xyz=vec3(-1.,-uv.x,uv.y);else xyz=vec3(uv.x,-1.,uv.y);xyz=normalize(xyz)*6371.0088;return vec4(xyz,1.);}vec4 getPosLocal(in vec2 pos){pos/=8192.;vec2 deltaBottom=uG.zw-uG.xy;vec2 deltaTop=uH.zw-uH.xy;vec2 bottomPosS=uG.xy+deltaBottom*pos.x;vec2 topPosS=uH.xy+deltaTop*pos.x;vec2 deltaS=topPosS-bottomPosS;vec2 res=bottomPosS+deltaS*pos.y;return vec4(res,0.,1.);}vec4 getPos(in vec2 pos){if(uF[1]<12.){return uI*STtoXYZ(pos);}else{return getPosLocal(pos);}}vec4 getZero(){if(uF[1]<12.){return uI*vec4(0.,0.,0.,1.);}else{return vec4(0.,0.,1.,1.);}}void main(){vec4 pos=getPos(aA);pos.xyz/=pos.w;pos.w=1.;float zoom=(uC[0]<0.)?uC[0]/1.45:uC[0];vec2 radius=uB/(uD*2.)/((zoom/1.35)+1.)/500.;aE=pos.xy;aE*=radius;aE+=vec2(300.,-175.)/uB;gl_Position=pos;}",uniforms:{uAspect:"uB",uInputs:"uC",uDevicePixelRatio:"uD",uFaceST:"uF",uBottom:"uG",uTop:"uH",uMatrix:"uI"},attributes:{aPos:"aA",vPos:"aE"}},u={source:"precision highp float;vec2 fadeStep=vec2(0.,0.325);vec4 nullColor=vec4(1.);vec4 darkColor=vec4(0.6,0.6,0.6,1.);varying vec2 aE;void main(){float len=length(aE);float fade=smoothstep(fadeStep.x,fadeStep.y,1.0-len);vec4 color=vec4(1.0);color=mix(darkColor,nullColor,fade);gl_FragColor=color;}",uniforms:{},attributes:{vPos:"aE"}},n={source:"#version 300 es\nprecision highp float;layout(location=0) in vec2 aC;uniform vec2 uD;uniform float uE[16];uniform float uF;uniform float uG[6];uniform vec4 uH;uniform vec4 uI;uniform mat4 uJ;float STtoUV(float s){if(s>=0.5) return(1./3.)*(4.*s*s-1.);else return(1./3.)*(1.-4.*(1.-s)*(1.-s));}vec4 STtoXYZ(in vec2 st){st/=8192.;int face=int(uG[0]);vec3 xyz;vec2 uv=vec2(STtoUV(uG[2]*st.x+uG[3]),STtoUV(uG[4]*st.y+uG[5]) );if(face==0) xyz=vec3(uv.x,uv.y,1.);else if(face==1) xyz=vec3(1.,uv.y,-uv.x);else if(face==2) xyz=vec3(-uv.y,1.,-uv.x);else if(face==3) xyz=vec3(-uv.y,-uv.x,-1.);else if(face==4) xyz=vec3(-1.,-uv.x,uv.y);else xyz=vec3(uv.x,-1.,uv.y);xyz=normalize(xyz)*6371.0088;return vec4(xyz,1.);}vec4 getPosLocal(in vec2 pos){pos/=8192.;vec2 deltaBottom=uH.zw-uH.xy;vec2 deltaTop=uI.zw-uI.xy;vec2 bottomPosS=uH.xy+deltaBottom*pos.x;vec2 topPosS=uI.xy+deltaTop*pos.x;vec2 deltaS=topPosS-bottomPosS;vec2 res=bottomPosS+deltaS*pos.y;return vec4(res,0.,1.);}vec4 getPos(in vec2 pos){if(uG[1]<12.){return uJ*STtoXYZ(pos);}else{return getPosLocal(pos);}}vec4 getZero(){if(uG[1]<12.){return uJ*vec4(0.,0.,0.,1.);}else{return vec4(0.,0.,1.,1.);}}out vec2 aA;void main(){vec4 pos=getPos(aC);pos.xyz/=pos.w;pos.w=1.;float zoom=(uE[0]<0.)?uE[0]/1.45:uE[0];vec2 radius=uD/(uF*2.)/((zoom/1.35)+1.)/500.;aA=pos.xy;aA*=radius;aA+=vec2(300.,-175.)/uD;gl_Position=pos;}",uniforms:{uAspect:"uD",uInputs:"uE",uDevicePixelRatio:"uF",uFaceST:"uG",uBottom:"uH",uTop:"uI",uMatrix:"uJ"},attributes:{aPos:"aC",vPos:"aA"}},a={source:"#version 300 es\nprecision highp float;vec2 fadeStep=vec2(0.,0.325);vec4 nullColor=vec4(1.);vec4 darkColor=vec4(0.6,0.6,0.6,1.);in vec2 aA;out vec4 aB;void main(){float len=length(aA);float fade=smoothstep(fadeStep.x,fadeStep.y,1.0-len);vec4 color=vec4(1.0);color=mix(darkColor,nullColor,fade);aB=color;}",uniforms:{},attributes:{vPos:"aA",fragColor:"aB"}};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&l(e,t)}(p,e);var t,o,r,s,h=(r=p,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(s){var o=v(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return f(this,e)});function p(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);var o=e.gl,r=e.type,s=e.devicePixelRatio;return 1===r&&(o.attributeLocations={aPos:0}),t=h.call(this,e),1===r?t.buildShaders(i,u):t.buildShaders(n,a),t.use(),t.setDevicePixelRatio(s),t}return t=p,(o=[{key:"draw",value:function(e,t){var o=this.gl,r=this.context,i=e.count,u=e.offset,n=e.mode;r.enableCullFace(),r.shadeBlend(),r.disableDepthTest(),o.drawElements(n||o.TRIANGLES,i,o.UNSIGNED_INT,4*(0|u))}}])&&c(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.Z)}}]);